/*! For license information please see cfc251a4-f86f820ac13aa2487f54.js.LICENSE.txt */
(self.webpackChunktransdiscipline=self.webpackChunktransdiscipline||[]).push([[341],{7803:function(t,e,i){var n=i(319),r=i(6525),s=i(1506),a=i(3913),l=i(4575),o=i(2205),h=i(8585),c=i(9754),u=i(5957);function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=c(t);if(e){var r=c(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return h(this,i)}}!function(t,e,i,h,_,f,y,g,v,p,m,x,k,b,A,C,S,w,L,R){"use strict";var D="4.2.7",O=function(t){o(i,t);var e=d(i);function i(){return l(this,i),e.apply(this,arguments)}return i}(u(Error)),B={CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},F=function(){function t(){l(this,t),this.enableDebugLog=!1,this._alreadyWarned={}}return a(t,[{key:"warn",value:function(t){return console&&(console.warn?console.warn(t):console.log&&console.log(t)),this}},{key:"warnOnce",value:function(t){return this._alreadyWarned[t]||(this._alreadyWarned[t]=!0,P.warn(t)),this}},{key:"debug",value:function(t){return this.enableDebugLog&&console&&(console.debug?console.debug(t):console.log&&console.log(t)),this}}]),t}(),P=new F,H=function(){function t(){l(this,t),this._defaultColors=t._schemeCategory20c,this.dateFormat=e.timeFormat("%m/%d/%Y"),this._renderlet=null,this.disableTransitions=!1}return a(t,[{key:"defaultColors",value:function(e){return arguments.length?(this._defaultColors=e,this):(this._defaultColors===t._schemeCategory20c&&P.warnOnce("You are using d3.schemeCategory20c, which has been removed in D3v5. See the explanation at https://github.com/d3/d3/blob/master/CHANGES.md#changes-in-d3-50. DC is using it for backward compatibility, however it will be changed in DCv3.1. You can change it by calling dc.config.defaultColors(newScheme). See https://github.com/d3/d3-scale-chromatic for some alternatives."),this._defaultColors)}}]),t}();H._schemeCategory20c=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];var T=new H,E={eventHandler:function(t){return function(e,i){console.warn("No d3.js compatbility event handler registered, defaulting to v6 behavior."),t.call(this,i,e)}},nester:function(t){throw t.key,t.sortKeys,t.sortValues,t.entries,new Error("No d3.js compatbility nester registered, load v5 or v6 compability layer.")},pointer:function(){throw new Error("No d3.js compatbility pointer registered, load v5 or v6 compability layer.")}},z=new(function(){function t(){l(this,t),this._chartMap={}}return a(t,[{key:"_initializeChartGroup",value:function(t){return t||(t=B.DEFAULT_CHART_GROUP),this._chartMap[t]||(this._chartMap[t]=[]),t}},{key:"has",value:function(t){for(var e in this._chartMap)if(this._chartMap[e].indexOf(t)>=0)return!0;return!1}},{key:"register",value:function(t,e){this._chartMap[e=this._initializeChartGroup(e)].push(t)}},{key:"deregister",value:function(t,e){e=this._initializeChartGroup(e);for(var i=0;i<this._chartMap[e].length;i++)if(this._chartMap[e][i].anchorName()===t.anchorName()){this._chartMap[e].splice(i,1);break}}},{key:"clear",value:function(t){t?delete this._chartMap[t]:this._chartMap={}}},{key:"list",value:function(t){return t=this._initializeChartGroup(t),this._chartMap[t]}}]),t}()),M=function(t,e){z.register(t,e)},N=function(t,e){z.deregister(t,e)},G=function(t){return z.has(t)},Y=function(t){z.clear(t)},V=function(t){for(var e=z.list(t),i=0;i<e.length;++i)e[i].filterAll()},I=function(t){for(var e=z.list(t),i=0;i<e.length;++i)e[i].focus&&e[i].focus()},W=function(t){for(var e=z.list(t),i=0;i<e.length;++i)e[i].render();null!==T._renderlet&&T._renderlet(t)},U=function(t){for(var e=z.list(t),i=0;i<e.length;++i)e[i].redraw();null!==T._renderlet&&T._renderlet(t)},X=function(t,e,i,n){if(T.disableTransitions||e<=0)return t;var r=t.transition(n);return(e>=0||void 0!==e)&&(r=r.duration(e)),(i>=0||void 0!==i)&&(r=r.delay(i)),r},j=function(t,e,i,n){return t?function(t){return X(t,e,i,n)}:function(t){return t}},K=function(t,e){if(t.empty()||!t.duration)e.call(t);else{var i=0;t.each((function(){++i})).on("end",(function(){--i||e.call(t)}))}},q=function(t){return arguments.length?(T._renderlet=t,null):T._renderlet},Z=function(t){return t instanceof Object&&t.__dcFlag__&&!0},J={current:null,trigger:function(t,e){e?(J.current=t,setTimeout((function(){t===J.current&&t()}),e)):t()}},Q={RangedFilter:function(t,e){var i=new Array(t,e);return i.isFiltered=function(t){return t>=this[0]&&t<this[1]},i.filterType="RangedFilter",i},TwoDimensionalFilter:function(t){if(null===t)return null;var e=t;return e.isFiltered=function(t){return t.length&&t.length===e.length&&t[0]===e[0]&&t[1]===e[1]},e.filterType="TwoDimensionalFilter",e},RangedTwoDimensionalFilter:function(t){if(null===t)return null;var e,i=t;return e=i[0]instanceof Array?[[Math.min(t[0][0],t[1][0]),Math.min(t[0][1],t[1][1])],[Math.max(t[0][0],t[1][0]),Math.max(t[0][1],t[1][1])]]:[[t[0],-1/0],[t[1],1/0]],i.isFiltered=function(t){var i,n;return t instanceof Array?(i=t[0],n=t[1]):(i=t,n=e[0][1]),i>=e[0][0]&&i<e[1][0]&&n>=e[0][1]&&n<e[1][1]},i.filterType="RangedTwoDimensionalFilter",i},HierarchyFilter:function(t){if(null===t)return null;var e=t.slice(0);return e.isFiltered=function(t){if(!(e.length&&t&&t.length&&t.length>=e.length))return!1;for(var i=0;i<e.length;i++)if(t[i]!==e[i])return!1;return!0},e}},$=function(t){o(i,t);var e=d(i);function i(){return l(this,i),e.apply(this,arguments)}return i}(u(Error)),tt=function(t,e){return e?function(i,n){return e.call(i,i[t],n)}:function(e){return e[t]}},et={printSingleValue:function(t){var e="".concat(t);return t instanceof Date?e=T.dateFormat(t):"string"==typeof t?e=t:et.isFloat(t)?e=et.printSingleValue.fformat(t):et.isInteger(t)&&(e=Math.round(t)),e}};et.printSingleValue.fformat=h.format(".2f"),et._toTimeFunc=function(t){return{second:i.timeSecond,minute:i.timeMinute,hour:i.timeHour,day:i.timeDay,week:i.timeWeek,month:i.timeMonth,year:i.timeYear}[t]},et.add=function(t,e,n){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date)return"string"==typeof e&&(e=+e),"millis"===n?new Date(t.getTime()+e):("function"!=typeof(n=n||i.timeDay)&&(n=et._toTimeFunc(n)),n.offset(t,e));if("string"==typeof e){var r=+e/100;return t>0?t*(1+r):t*(1-r)}return t+e},et.subtract=function(t,e,n){if("string"==typeof e&&(e=e.replace("%","")),t instanceof Date)return"string"==typeof e&&(e=+e),"millis"===n?new Date(t.getTime()-e):("function"!=typeof(n=n||i.timeDay)&&(n=et._toTimeFunc(n)),n.offset(t,-e));if("string"==typeof e){var r=+e/100;return t<0?t*(1+r):t*(1-r)}return t-e},et.isNumber=function(t){return t===+t},et.isFloat=function(t){return t===+t&&t!==(0|t)},et.isInteger=function(t){return t===+t&&t===(0|t)},et.isNegligible=function(t){return!et.isNumber(t)||t<B.NEGLIGIBLE_NUMBER&&t>-B.NEGLIGIBLE_NUMBER},et.clamp=function(t,e,i){return t<e?e:t>i?i:t},et.constant=function(t){return function(){return t}};var it=0;function nt(t,e){for(var i=0;i<t.length;i++)if(t[i].key===e)return t[i]}et.uniqueId=function(){return++it},et.nameToId=function(t){return t.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")},et.appendOrSelect=function(t,e,i){i=i||e;var n=t.select(e);return n.empty()&&(n=t.append(i)),n},et.safeNumber=function(t){return et.isNumber(+t)?+t:0},et.arraysEqual=function(t,e){return!t&&!e||!(!t||!e)&&t.length===e.length&&t.every((function(t,i){return t.valueOf()===e[i].valueOf()}))},et.allChildren=function(t){var e=[];if(e.push(t.path),console.log("currentNode",t),t.children)for(var i=0;i<t.children.length;i++)e=e.concat(et.allChildren(t.children[i]));return e},et.toHierarchy=function(t,e){for(var i={key:"root",children:[]},n=0;n<t.length;n++)for(var r=t[n],s=r.key,a=e(r),l=i,o=0;o<s.length;o++){var h=s.slice(0,o+1),c=l.children,u=s[o],d=void 0;o+1<s.length?(void 0===(d=nt(c,u))&&(d={key:u,children:[],path:h},c.push(d)),l=d):(d={key:u,value:a,data:r,path:h},c.push(d))}return i},et.getAncestors=function(t){for(var e=[],i=t;i.parent;)e.unshift(i.name),i=i.parent;return e},et.arraysIdentical=function(t,e){var i=t.length;if(i!==e.length)return!1;for(;i--;)if(t[i]!==e[i])return!1;return!0};var rt={filters:function(t){for(var e="",i=0;i<t.length;++i)i>0&&(e+=", "),e+=rt.filter(t[i]);return e},filter:function(t){var e="";return null!=t&&(t instanceof Array?t.length>=2?e="[".concat(t.map((function(t){return et.printSingleValue(t)})).join(" -> "),"]"):t.length>=1&&(e=et.printSingleValue(t[0])):e=et.printSingleValue(t)),e}},st={integers:function(t,e){return Math.abs(e-t)},ordinal:function(){throw new Error("dc.units.ordinal should not be called - it is a placeholder")},fp:{}};st.fp.precision=function(t){var e=function t(e,i){var n=Math.abs((i-e)/t.resolution);return et.isNegligible(n-Math.floor(n))?Math.floor(n):Math.ceil(n)};return e.resolution=t,e};var at=function(t,e){return 0===e.length?t.filter(null):1!==e.length||e[0].isFiltered?1===e.length&&"RangedFilter"===e[0].filterType?t.filterRange(e[0]):t.filterFunction((function(t){for(var i=0;i<e.length;i++){var n=e[i];if(n.isFiltered){if(n.isFiltered(t))return!0}else if(n<=t&&n>=t)return!0}return!1})):t.filterExact(e[0]),e},lt=function(t,e){return null==e?t.length>0:t.some((function(t){return e<=t&&e>=t}))},ot=function(t,e){for(var i=0;i<t.length;i++)if(t[i]<=e&&t[i]>=e){t.splice(i,1);break}return t},ht=function(t,e){return t.push(e),t},ct=function(t){return[]},ut=function(){function t(){var e=this;l(this,t),this.__dcFlag__=et.uniqueId(),this._svgDescription=null,this._keyboardAccessible=!1,this._dimension=void 0,this._group=void 0,this._anchor=void 0,this._root=void 0,this._svg=void 0,this._isChild=void 0,this._minWidth=200,this._defaultWidthCalc=function(t){var i=t&&t.getBoundingClientRect&&t.getBoundingClientRect().width;return i&&i>e._minWidth?i:e._minWidth},this._widthCalc=this._defaultWidthCalc,this._minHeight=200,this._defaultHeightCalc=function(t){var i=t&&t.getBoundingClientRect&&t.getBoundingClientRect().height;return i&&i>e._minHeight?i:e._minHeight},this._heightCalc=this._defaultHeightCalc,this._width=void 0,this._height=void 0,this._useViewBoxResizing=!1,this._keyAccessor=tt("key"),this._valueAccessor=tt("value"),this._label=tt("key"),this._ordering=tt("key"),this._renderLabel=!1,this._title=function(t){return"".concat(e.keyAccessor()(t),": ").concat(e.valueAccessor()(t))},this._renderTitle=!0,this._controlsUseVisibility=!1,this._transitionDuration=750,this._transitionDelay=0,this._filterPrinter=rt.filters,this._mandatoryAttributesList=["dimension","group"],this._chartGroup=B.DEFAULT_CHART_GROUP,this._listeners=f.dispatch("preRender","postRender","preRedraw","postRedraw","filtered","zoomed","renderlet","pretransition"),this._legend=void 0,this._commitHandler=void 0,this._defaultData=function(t){return t.all()},this._data=this._defaultData,this._filters=[],this._filterHandler=at,this._hasFilterHandler=lt,this._removeFilterHandler=ot,this._addFilterHandler=ht,this._resetFilterHandler=ct}return a(t,[{key:"height",value:function(t){return arguments.length?(this._heightCalc=t?"function"==typeof t?t:et.constant(t):this._defaultHeightCalc,this._height=void 0,this):(et.isNumber(this._height)||(this._height=this._heightCalc(this._root.node())),this._height)}},{key:"width",value:function(t){return arguments.length?(this._widthCalc=t?"function"==typeof t?t:et.constant(t):this._defaultWidthCalc,this._width=void 0,this):(et.isNumber(this._width)||(this._width=this._widthCalc(this._root.node())),this._width)}},{key:"minWidth",value:function(t){return arguments.length?(this._minWidth=t,this):this._minWidth}},{key:"minHeight",value:function(t){return arguments.length?(this._minHeight=t,this):this._minHeight}},{key:"useViewBoxResizing",value:function(t){return arguments.length?(this._useViewBoxResizing=t,this):this._useViewBoxResizing}},{key:"dimension",value:function(t){return arguments.length?(this._dimension=t,this.expireCache(),this):this._dimension}},{key:"data",value:function(t){return arguments.length?(this._data="function"==typeof t?t:et.constant(t),this.expireCache(),this):this._data(this._group)}},{key:"group",value:function(t,e){return arguments.length?(this._group=t,this._groupName=e,this.expireCache(),this):this._group}},{key:"ordering",value:function(t){return arguments.length?(this._ordering=t,this.expireCache(),this):this._ordering}},{key:"_computeOrderedGroups",value:function(t){var e=this;return Array.from(t).sort((function(t,i){return y.ascending(e._ordering(t),e._ordering(i))}))}},{key:"filterAll",value:function(){return this.filter(null)}},{key:"select",value:function(t){return this._root.select(t)}},{key:"selectAll",value:function(t){return this._root?this._root.selectAll(t):null}},{key:"anchor",value:function(t,e){if(!arguments.length)return this._anchor;if(Z(t))this._anchor=t.anchor(),this._anchor.children&&(this._anchor="#".concat(t.anchorName())),this._root=t.root(),this._isChild=!0;else{if(!t)throw new O("parent must be defined");t.select&&t.classed?this._anchor=t.node():this._anchor=t,this._root=_.select(this._anchor),this._root.classed(B.CHART_CLASS,!0),M(this,e),this._isChild=!1}return this._chartGroup=e,this}},{key:"anchorName",value:function(){var t=this.anchor();return t&&t.id?t.id:t&&t.replace?t.replace("#",""):"dc-chart".concat(this.chartID())}},{key:"root",value:function(t){return arguments.length?(this._root=t,this):this._root}},{key:"svg",value:function(t){return arguments.length?(this._svg=t,this):this._svg}},{key:"resetSvg",value:function(){return this.select("svg").remove(),this.generateSvg()}},{key:"sizeSvg",value:function(){this._svg&&(this._useViewBoxResizing?this._svg.attr("viewBox")||this._svg.attr("viewBox","0 0 ".concat(this.width()," ").concat(this.height())):this._svg.attr("width",this.width()).attr("height",this.height()))}},{key:"generateSvg",value:function(){return this._svg=this.root().append("svg"),(this._svgDescription||this._keyboardAccessible)&&(this._svg.append("desc").attr("id","desc-id-".concat(this.__dcFlag__)).html("".concat(this.svgDescription())),this._svg.attr("tabindex","0").attr("role","img").attr("aria-labelledby","desc-id-".concat(this.__dcFlag__))),this.sizeSvg(),this._svg}},{key:"svgDescription",value:function(t){return arguments.length?(this._svgDescription=t,this):this._svgDescription||this.constructor.name}},{key:"keyboardAccessible",value:function(t){return arguments.length?(this._keyboardAccessible=t,this):this._keyboardAccessible}},{key:"filterPrinter",value:function(t){return arguments.length?(this._filterPrinter=t,this):this._filterPrinter}},{key:"controlsUseVisibility",value:function(t){return arguments.length?(this._controlsUseVisibility=t,this):this._controlsUseVisibility}},{key:"turnOnControls",value:function(){if(this._root){var t=this.controlsUseVisibility()?"visibility":"display";this.selectAll(".reset").style(t,null),this.selectAll(".filter").text(this._filterPrinter(this.filters())).style(t,null)}return this}},{key:"turnOffControls",value:function(){if(this._root){var t=this.controlsUseVisibility()?"visibility":"display",e=this.controlsUseVisibility()?"hidden":"none";this.selectAll(".reset").style(t,e),this.selectAll(".filter").style(t,e).text(this.filter())}return this}},{key:"transitionDuration",value:function(t){return arguments.length?(this._transitionDuration=t,this):this._transitionDuration}},{key:"transitionDelay",value:function(t){return arguments.length?(this._transitionDelay=t,this):this._transitionDelay}},{key:"_mandatoryAttributes",value:function(t){return arguments.length?(this._mandatoryAttributesList=t,this):this._mandatoryAttributesList}},{key:"checkForMandatoryAttributes",value:function(t){if(!this[t]||!this[t]())throw new $("Mandatory attribute chart.".concat(t," is missing on chart[#").concat(this.anchorName(),"]"))}},{key:"render",value:function(){var t=this;this._height=this._width=void 0,this._listeners.call("preRender",this,this),this._mandatoryAttributesList&&this._mandatoryAttributesList.forEach((function(e){return t.checkForMandatoryAttributes(e)}));var e=this._doRender();return this._legend&&this._legend.render(),this._activateRenderlets("postRender"),e}},{key:"_makeKeyboardAccessible",value:function(t){for(var e=this,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=this._svg.selectAll(".dc-tabbable").attr("tabindex",0);t&&s.on("keydown",E.eventHandler((function(i,r){13===r.keyCode&&"object"==typeof i&&t.call.apply(t,[e,i].concat(n)),32===r.keyCode&&"object"==typeof i&&(t.call.apply(t,[e,i].concat(n)),r.preventDefault())})))}},{key:"_activateRenderlets",value:function(t){var e=this;this._listeners.call("pretransition",this,this),this.transitionDuration()>0&&this._svg?this._svg.transition().duration(this.transitionDuration()).delay(this.transitionDelay()).on("end",(function(){e._listeners.call("renderlet",e,e),t&&e._listeners.call(t,e,e)})):(this._listeners.call("renderlet",this,this),t&&this._listeners.call(t,this,this))}},{key:"redraw",value:function(){this.sizeSvg(),this._listeners.call("preRedraw",this,this);var t=this._doRedraw();return this._legend&&this._legend.render(),this._activateRenderlets("postRedraw"),t}},{key:"commitHandler",value:function(t){return arguments.length?(this._commitHandler=t,this):this._commitHandler}},{key:"redrawGroup",value:function(){var t=this;return this._commitHandler?this._commitHandler(!1,(function(e,i){e?console.log(e):U(t.chartGroup())})):U(this.chartGroup()),this}},{key:"renderGroup",value:function(){var t=this;return this._commitHandler?this._commitHandler(!1,(function(e,i){e?console.log(e):W(t.chartGroup())})):W(this.chartGroup()),this}},{key:"_invokeFilteredListener",value:function(t){void 0!==t&&this._listeners.call("filtered",this,this,t)}},{key:"_invokeZoomedListener",value:function(){this._listeners.call("zoomed",this,this)}},{key:"hasFilterHandler",value:function(t){return arguments.length?(this._hasFilterHandler=t,this):this._hasFilterHandler}},{key:"hasFilter",value:function(t){return this._hasFilterHandler(this._filters,t)}},{key:"removeFilterHandler",value:function(t){return arguments.length?(this._removeFilterHandler=t,this):this._removeFilterHandler}},{key:"addFilterHandler",value:function(t){return arguments.length?(this._addFilterHandler=t,this):this._addFilterHandler}},{key:"resetFilterHandler",value:function(t){return arguments.length?(this._resetFilterHandler=t,this):this._resetFilterHandler}},{key:"applyFilters",value:function(t){if(this.dimension()&&this.dimension().filter){var e=this._filterHandler(this.dimension(),t);e&&(t=e)}return t}},{key:"replaceFilter",value:function(t){return this._filters=this._resetFilterHandler(this._filters),this.filter(t),this}},{key:"filter",value:function(t){var e=this;if(!arguments.length)return this._filters.length>0?this._filters[0]:null;var i=this._filters;return t instanceof Array&&t[0]instanceof Array&&!t.isFiltered?t[0].forEach((function(t){i=e._hasFilterHandler(i,t)?e._removeFilterHandler(i,t):e._addFilterHandler(i,t)})):i=null===t?this._resetFilterHandler(i):this._hasFilterHandler(i,t)?this._removeFilterHandler(i,t):this._addFilterHandler(i,t),this._filters=this.applyFilters(i),this._invokeFilteredListener(t),null!==this._root&&this.hasFilter()?this.turnOnControls():this.turnOffControls(),this}},{key:"filters",value:function(){return this._filters}},{key:"highlightSelected",value:function(t){_.select(t).classed(B.SELECTED_CLASS,!0),_.select(t).classed(B.DESELECTED_CLASS,!1)}},{key:"fadeDeselected",value:function(t){_.select(t).classed(B.SELECTED_CLASS,!1),_.select(t).classed(B.DESELECTED_CLASS,!0)}},{key:"resetHighlight",value:function(t){_.select(t).classed(B.SELECTED_CLASS,!1),_.select(t).classed(B.DESELECTED_CLASS,!1)}},{key:"onClick",value:function(t){var e=this,i=this.keyAccessor()(t);J.trigger((function(){e.filter(i),e.redrawGroup()}))}},{key:"filterHandler",value:function(t){return arguments.length?(this._filterHandler=t,this):this._filterHandler}},{key:"_doRender",value:function(){return this}},{key:"_doRedraw",value:function(){return this}},{key:"legendables",value:function(){return[]}},{key:"legendHighlight",value:function(){}},{key:"legendReset",value:function(){}},{key:"legendToggle",value:function(){}},{key:"isLegendableHidden",value:function(){return!1}},{key:"keyAccessor",value:function(t){return arguments.length?(this._keyAccessor=t,this):this._keyAccessor}},{key:"valueAccessor",value:function(t){return arguments.length?(this._valueAccessor=t,this):this._valueAccessor}},{key:"label",value:function(t,e){return arguments.length?(this._label=t,(void 0===e||e)&&(this._renderLabel=!0),this):this._label}},{key:"renderLabel",value:function(t){return arguments.length?(this._renderLabel=t,this):this._renderLabel}},{key:"title",value:function(t){return arguments.length?(this._title=t,this):this._title}},{key:"renderTitle",value:function(t){return arguments.length?(this._renderTitle=t,this):this._renderTitle}},{key:"chartGroup",value:function(t){return arguments.length?(this._isChild||N(this,this._chartGroup),this._chartGroup=t,this._isChild||M(this,this._chartGroup),this):this._chartGroup}},{key:"expireCache",value:function(){return this}},{key:"legend",value:function(t){return arguments.length?(this._legend=t,this._legend.parent(this),this):this._legend}},{key:"chartID",value:function(){return this.__dcFlag__}},{key:"options",value:function(t){var e=["anchor","group","xAxisLabel","yAxisLabel","stack","title","point","getColor","overlayGeoJson"];for(var i in t)"function"==typeof this[i]?t[i]instanceof Array&&-1!==e.indexOf(i)?this[i].apply(this,t[i]):this[i].call(this,t[i]):P.debug("Not a valid option setter name: ".concat(i));return this}},{key:"on",value:function(t,e){return this._listeners.on(t,e),this}},{key:"renderlet",value:function(t){return P.warnOnce('chart.renderlet has been deprecated. Please use chart.on("renderlet.<renderletKey>", renderletFunction)'),this.on("renderlet.".concat(et.uniqueId()),t),this}}]),t}(),dt=function(){return new ut},_t=function(t){return function(t){o(i,t);var e=d(i);function i(){var t;l(this,i),(t=e.call(this))._colors=g.scaleOrdinal(T.defaultColors()),t._colorAccessor=function(e){return t.keyAccessor()(e)},t._colorCalculator=void 0;var n=s(t);return n.getColor=function(t,e){return n._colorCalculator?n._colorCalculator.call(this,t,e):n._colors(n._colorAccessor.call(this,t,e))},t}return a(i,[{key:"calculateColorDomain",value:function(){var t=[y.min(this.data(),this.colorAccessor()),y.max(this.data(),this.colorAccessor())];return this._colors.domain(t),this}},{key:"colors",value:function(t){return arguments.length?(this._colors=t instanceof Array?g.scaleQuantize().range(t):"function"==typeof t?t:et.constant(t),this):this._colors}},{key:"ordinalColors",value:function(t){return this.colors(g.scaleOrdinal().range(t))}},{key:"linearColors",value:function(t){return this.colors(g.scaleLinear().range(t).interpolate(v.interpolateHcl))}},{key:"colorAccessor",value:function(t){return arguments.length?(this._colorAccessor=t,this):this._colorAccessor}},{key:"colorDomain",value:function(t){return arguments.length?(this._colors.domain(t),this):this._colors.domain()}},{key:"colorCalculator",value:function(t){return arguments.length?(this._colorCalculator=t,this):this._colorCalculator||this.getColor}}]),i}(t)},ft=function(t){return function(t){o(i,t);var e=d(i);function i(){var t;return l(this,i),(t=e.call(this))._maxBubbleRelativeSize=.3,t._minRadiusWithLabel=10,t._sortBubbleSize=!1,t._elasticRadius=!1,t._excludeElasticZero=!0,t.BUBBLE_NODE_CLASS="node",t.BUBBLE_CLASS="bubble",t.MIN_RADIUS=10,t.renderLabel(!0),t.data((function(e){var i=e.all();if(t._keyboardAccessible&&i.sort((function(e,i){return y.ascending(t.keyAccessor()(e),t.keyAccessor()(i))})),t._sortBubbleSize){var n=t.radiusValueAccessor();i.sort((function(t,e){return y.descending(n(t),n(e))}))}return i})),t._r=g.scaleLinear().domain([0,100]),t}return a(i,[{key:"_rValueAccessor",value:function(t){return t.r}},{key:"r",value:function(t){return arguments.length?(this._r=t,this):this._r}},{key:"elasticRadius",value:function(t){return arguments.length?(this._elasticRadius=t,this):this._elasticRadius}},{key:"calculateRadiusDomain",value:function(){this._elasticRadius&&this.r().domain([this.rMin(),this.rMax()])}},{key:"radiusValueAccessor",value:function(t){return arguments.length?(this._rValueAccessor=t,this):this._rValueAccessor}},{key:"rMin",value:function(){var t=this.data().map(this.radiusValueAccessor());return this._excludeElasticZero&&(t=t.filter((function(t){return t>0}))),y.min(t)}},{key:"rMax",value:function(){var t=this;return y.max(this.data(),(function(e){return t.radiusValueAccessor()(e)}))}},{key:"bubbleR",value:function(t){var e=this.radiusValueAccessor()(t),i=this.r()(e);return(isNaN(i)||e<=0)&&(i=0),i}},{key:"_labelFunction",value:function(t){return this.label()(t)}},{key:"_shouldLabel",value:function(t){return this.bubbleR(t)>this._minRadiusWithLabel}},{key:"_labelOpacity",value:function(t){return this._shouldLabel(t)?1:0}},{key:"_labelPointerEvent",value:function(t){return this._shouldLabel(t)?"all":"none"}},{key:"_doRenderLabel",value:function(t){var e=this;if(this.renderLabel()){var i=t.select("text");i.empty()&&(i=t.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",E.eventHandler((function(t){return e.onClick(t)})))),i.attr("opacity",0).attr("pointer-events",(function(t){return e._labelPointerEvent(t)})).text((function(t){return e._labelFunction(t)})),X(i,this.transitionDuration(),this.transitionDelay()).attr("opacity",(function(t){return e._labelOpacity(t)}))}}},{key:"doUpdateLabels",value:function(t){var e=this;if(this.renderLabel()){var i=t.select("text").attr("pointer-events",(function(t){return e._labelPointerEvent(t)})).text((function(t){return e._labelFunction(t)}));X(i,this.transitionDuration(),this.transitionDelay()).attr("opacity",(function(t){return e._labelOpacity(t)}))}}},{key:"_titleFunction",value:function(t){return this.title()(t)}},{key:"_doRenderTitles",value:function(t){var e=this;this.renderTitle()&&t.select("title").empty()&&t.append("title").text((function(t){return e._titleFunction(t)}))}},{key:"doUpdateTitles",value:function(t){var e=this;this.renderTitle()&&t.select("title").text((function(t){return e._titleFunction(t)}))}},{key:"sortBubbleSize",value:function(t){return arguments.length?(this._sortBubbleSize=t,this):this._sortBubbleSize}},{key:"minRadius",value:function(t){return arguments.length?(this.MIN_RADIUS=t,this):this.MIN_RADIUS}},{key:"minRadiusWithLabel",value:function(t){return arguments.length?(this._minRadiusWithLabel=t,this):this._minRadiusWithLabel}},{key:"maxBubbleRelativeSize",value:function(t){return arguments.length?(this._maxBubbleRelativeSize=t,this):this._maxBubbleRelativeSize}},{key:"excludeElasticZero",value:function(t){return arguments.length?(this._excludeElasticZero=t,this):this._excludeElasticZero}},{key:"fadeDeselectedArea",value:function(t){if(this.hasFilter()){var e=this;this.selectAll("g.".concat(e.BUBBLE_NODE_CLASS)).each((function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}))}else{var i=this;this.selectAll("g.".concat(i.BUBBLE_NODE_CLASS)).each((function(){i.resetHighlight(this)}))}}},{key:"isSelectedNode",value:function(t){return this.hasFilter(t.key)}},{key:"onClick",value:function(t){var e=this,i=t.key;J.trigger((function(){e.filter(i),e.redrawGroup()}))}}]),i}(_t(t))},yt=function(t){return function(t){o(i,t);var e=d(i);function i(){var t;return l(this,i),(t=e.call(this))._cap=1/0,t._takeFront=!0,t._othersLabel="Others",t._othersGrouper=function(e,i){var n=y.sum(i,t.valueAccessor()),r=i.map(t.keyAccessor());return n>0?e.concat([{others:r,key:t.othersLabel(),value:n}]):e},t.ordering((function(t){return-t.value})),t.data((function(e){if(t._cap===1/0)return t._computeOrderedGroups(e.all());var i,n=e.all();if(n=t._computeOrderedGroups(n),t._cap)if(t._takeFront)i=n.slice(t._cap),n=n.slice(0,t._cap);else{var r=Math.max(0,n.length-t._cap);i=n.slice(0,r),n=n.slice(r)}return t._othersGrouper?t._othersGrouper(n,i):n})),t}return a(i,[{key:"cappedKeyAccessor",value:function(t,e){return t.others?t.key:this.keyAccessor()(t,e)}},{key:"cappedValueAccessor",value:function(t,e){return t.others?t.value:this.valueAccessor()(t,e)}},{key:"cap",value:function(t){return arguments.length?(this._cap=t,this):this._cap}},{key:"takeFront",value:function(t){return arguments.length?(this._takeFront=t,this):this._takeFront}},{key:"othersLabel",value:function(t){return arguments.length?(this._othersLabel=t,this):this._othersLabel}},{key:"othersGrouper",value:function(t){return arguments.length?(this._othersGrouper=t,this):this._othersGrouper}},{key:"onClick",value:function(t){t.others&&this.filter([t.others]),r(c(i.prototype),"onClick",this).call(this,t)}}]),i}(t)},gt=function(t){o(i,t);var e=d(i);function i(){var t;return l(this,i),(t=e.call(this))._margin={top:10,right:50,bottom:30,left:30},t}return a(i,[{key:"margins",value:function(t){return arguments.length?(this._margin=t,this):this._margin}},{key:"effectiveWidth",value:function(){return this.width()-this.margins().left-this.margins().right}},{key:"effectiveHeight",value:function(){return this.height()-this.margins().top-this.margins().bottom}}]),i}(ut),vt="grid-line",pt="horizontal",mt="vertical",xt="y-axis-label",kt="x-axis-label",bt="custom-brush-handle",At=12,Ct=function(t){o(n,t);var e=d(n);function n(){var t;return l(this,n),(t=e.call(this)).colors(g.scaleOrdinal(p.schemeCategory10)),t._mandatoryAttributes().push("x"),t._parent=void 0,t._g=void 0,t._chartBodyG=void 0,t._x=void 0,t._origX=void 0,t._xOriginalDomain=void 0,t._xAxis=null,t._xUnits=st.integers,t._xAxisPadding=0,t._xAxisPaddingUnit=i.timeDay,t._xElasticity=!1,t._xAxisLabel=void 0,t._xAxisLabelPadding=0,t._lastXDomain=void 0,t._y=void 0,t._yAxis=null,t._yAxisPadding=0,t._yElasticity=!1,t._yAxisLabel=void 0,t._yAxisLabelPadding=0,t._brush=k.brushX(),t._gBrush=void 0,t._brushOn=!0,t._parentBrushOn=!1,t._round=void 0,t._ignoreBrushEvents=!1,t._renderHorizontalGridLine=!1,t._renderVerticalGridLine=!1,t._resizing=!1,t._unitCount=void 0,t._zoomScale=[1,1/0],t._zoomOutRestrict=!0,t._zoom=x.zoom().on("zoom",E.eventHandler((function(e,i){return t._onZoom(i)}))),t._nullZoom=x.zoom().on("zoom",null),t._hasBeenMouseZoomable=!1,t._ignoreZoomEvents=!1,t._rangeChart=void 0,t._focusChart=void 0,t._mouseZoomable=!1,t._clipPadding=0,t._fOuterRangeBandPadding=.5,t._fRangeBandPadding=0,t._useRightYAxis=!1,t._useTopXAxis=!1,t}return a(n,[{key:"rescale",value:function(){return this._unitCount=void 0,this._resizing=!0,this}},{key:"resizing",value:function(t){return arguments.length?(this._resizing=t,this):this._resizing}},{key:"rangeChart",value:function(t){return arguments.length?(this._rangeChart=t,this._rangeChart.focusChart(this),this):this._rangeChart}},{key:"zoomScale",value:function(t){return arguments.length?(this._zoomScale=t,this):this._zoomScale}},{key:"zoomOutRestrict",value:function(t){return arguments.length?(this._zoomOutRestrict=t,this):this._zoomOutRestrict}},{key:"_generateG",value:function(t){this._parent=void 0===t?this.svg():t;var e=window.location.href.split("#")[0];return this._g=this._parent.append("g"),this._chartBodyG=this._g.append("g").attr("class","chart-body").attr("transform","translate(".concat(this.margins().left,", ").concat(this.margins().top,")")).attr("clip-path","url(".concat(e,"#").concat(this._getClipPathId(),")")),this._g}},{key:"g",value:function(t){return arguments.length?(this._g=t,this):this._g}},{key:"mouseZoomable",value:function(t){return arguments.length?(this._mouseZoomable=t,this):this._mouseZoomable}},{key:"chartBodyG",value:function(t){return arguments.length?(this._chartBodyG=t,this):this._chartBodyG}},{key:"x",value:function(t){return arguments.length?(this._x=t,this._xOriginalDomain=this._x.domain(),this.rescale(),this):this._x}},{key:"xOriginalDomain",value:function(){return this._xOriginalDomain}},{key:"xUnits",value:function(t){return arguments.length?(this._xUnits=t,this):this._xUnits}},{key:"xAxis",value:function(t){return arguments.length?(this._xAxis=t,this):(this._xAxis||(this._xAxis=this._createXAxis()),this._xAxis)}},{key:"elasticX",value:function(t){return arguments.length?(this._xElasticity=t,this):this._xElasticity}},{key:"xAxisPadding",value:function(t){return arguments.length?(this._xAxisPadding=t,this):this._xAxisPadding}},{key:"xAxisPaddingUnit",value:function(t){return arguments.length?(this._xAxisPaddingUnit=t,this):this._xAxisPaddingUnit}},{key:"xUnitCount",value:function(){return void 0===this._unitCount&&(this.isOrdinal()?this._unitCount=this.x().domain().length:(this._unitCount=this.xUnits()(this.x().domain()[0],this.x().domain()[1]),this._unitCount instanceof Array&&(this._unitCount=this._unitCount.length))),this._unitCount}},{key:"useRightYAxis",value:function(t){return arguments.length?(this._useRightYAxis!==t&&this._yAxis&&P.warn("Value of useRightYAxis has been altered, after yAxis was created. You might get unexpected yAxis behavior. Make calls to useRightYAxis sooner in your chart creation process."),this._useRightYAxis=t,this):this._useRightYAxis}},{key:"useTopXAxis",value:function(t){return arguments.length?(this._useTopXAxis!==t&&this._xAxis&&P.warn("Value of useTopXAxis has been altered, after xAxis was created. You might get unexpected yAxis behavior. Make calls to useTopXAxis sooner in your chart creation process."),this._useTopXAxis=t,this):this._useTopXAxis}},{key:"isOrdinal",value:function(){return this.xUnits()===st.ordinal}},{key:"_useOuterPadding",value:function(){return!0}},{key:"_ordinalXDomain",value:function(){return this._computeOrderedGroups(this.data()).map(this.keyAccessor())}},{key:"_createXAxis",value:function(){return this._useTopXAxis?m.axisTop():m.axisBottom()}},{key:"_prepareXAxis",value:function(t,e){this.isOrdinal()?(this._x.bandwidth||(P.warn("For compatibility with d3v4+, dc.js d3.0 ordinal bar/line/bubble charts need d3.scaleBand() for the x scale, instead of d3.scaleOrdinal(). Replacing .x() with a d3.scaleBand with the same domain - make the same change in your code to avoid this warning!"),this._x=g.scaleBand().domain(this._x.domain())),(this.elasticX()||0===this._x.domain().length)&&this._x.domain(this._ordinalXDomain())):this.elasticX()&&this._x.domain([this.xAxisMin(),this.xAxisMax()]);var i=this._x.domain();!e&&et.arraysEqual(this._lastXDomain,i)||this.rescale(),this._lastXDomain=i,this.isOrdinal()?this._x.range([0,this.xAxisLength()]).paddingInner(this._fRangeBandPadding).paddingOuter(this._useOuterPadding()?this._fOuterRangeBandPadding:0):this._x.range([0,this.xAxisLength()]),this._xAxis||(this._xAxis=this._createXAxis()),this._xAxis=this._xAxis.scale(this.x()),this._renderVerticalGridLines(t)}},{key:"renderXAxis",value:function(t){var e=t.select("g.x");e.empty()&&(e=t.append("g").attr("class","axis x").attr("transform","translate(".concat(this.margins().left,",").concat(this._xAxisY(),")")));var i=t.select("text.".concat(kt)),n=this._useTopXAxis?this._xAxisLabelPadding:this.height()-this._xAxisLabelPadding;i.empty()&&this.xAxisLabel()&&(i=t.append("text").attr("class",kt).attr("transform","translate(".concat(this.margins().left+this.xAxisLength()/2,",").concat(n,")")).attr("text-anchor","middle")),this.xAxisLabel()&&i.text()!==this.xAxisLabel()&&i.text(this.xAxisLabel()),X(e,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(this.margins().left,",").concat(this._xAxisY(),")")).call(this._xAxis),X(i,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(this.margins().left+this.xAxisLength()/2,",").concat(n,")"))}},{key:"_renderVerticalGridLines",value:function(t){var e=this,i=t.select("g.".concat(mt));if(this._renderVerticalGridLine){i.empty()&&(i=t.insert("g",":first-child").attr("class","".concat(vt," ").concat(mt)).attr("transform","translate(".concat(this.margins().left,",").concat(this.margins().top,")")));var n=this._xAxis.tickValues()?this._xAxis.tickValues():"function"==typeof this._x.ticks?this._x.ticks.apply(this._x,this._xAxis.tickArguments()):this._x.domain(),r=i.selectAll("line").data(n),s=r.enter().append("line").attr("x1",(function(t){return e._x(t)})).attr("y1",this._xAxisY()-this.margins().top).attr("x2",(function(t){return e._x(t)})).attr("y2",0).attr("opacity",0);X(s,this.transitionDuration(),this.transitionDelay()).attr("opacity",.5),X(r,this.transitionDuration(),this.transitionDelay()).attr("x1",(function(t){return e._x(t)})).attr("y1",this._xAxisY()-this.margins().top).attr("x2",(function(t){return e._x(t)})).attr("y2",0),r.exit().remove()}else i.selectAll("line").remove()}},{key:"_xAxisY",value:function(){return this._useTopXAxis?this.margins().top:this.height()-this.margins().bottom}},{key:"xAxisLength",value:function(){return this.effectiveWidth()}},{key:"xAxisLabel",value:function(t,e){return arguments.length?(this._xAxisLabel=t,this.margins().bottom-=this._xAxisLabelPadding,this._xAxisLabelPadding=void 0===e?At:e,this.margins().bottom+=this._xAxisLabelPadding,this):this._xAxisLabel}},{key:"_createYAxis",value:function(){return this._useRightYAxis?m.axisRight():m.axisLeft()}},{key:"_prepareYAxis",value:function(t){if(void 0===this._y||this.elasticY()){void 0===this._y&&(this._y=g.scaleLinear());var e=this.yAxisMin()||0,i=this.yAxisMax()||0;this._y.domain([e,i]).rangeRound([this.yAxisHeight(),0])}this._y.range([this.yAxisHeight(),0]),this._yAxis||(this._yAxis=this._createYAxis()),this._yAxis.scale(this._y),this._renderHorizontalGridLinesForAxis(t,this._y,this._yAxis)}},{key:"renderYAxisLabel",value:function(t,e,i,n){n=n||this._yAxisLabelPadding;var r=this.g().select("text.".concat(xt,".").concat(t,"-label")),s=this.margins().top+this.yAxisHeight()/2;r.empty()&&e&&(r=this.g().append("text").attr("transform","translate(".concat(n,",").concat(s,"),rotate(").concat(i,")")).attr("class","".concat(xt," ").concat(t,"-label")).attr("text-anchor","middle").text(e)),e&&r.text()!==e&&r.text(e),X(r,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(n,",").concat(s,"),rotate(").concat(i,")"))}},{key:"renderYAxisAt",value:function(t,e,i){var n=this.g().select("g.".concat(t));n.empty()&&(n=this.g().append("g").attr("class","axis ".concat(t)).attr("transform","translate(".concat(i,",").concat(this.margins().top,")"))),X(n,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(i,",").concat(this.margins().top,")")).call(e)}},{key:"renderYAxis",value:function(){var t=this._useRightYAxis?this.width()-this.margins().right:this._yAxisX();this.renderYAxisAt("y",this._yAxis,t);var e=this._useRightYAxis?this.width()-this._yAxisLabelPadding:this._yAxisLabelPadding,i=this._useRightYAxis?90:-90;this.renderYAxisLabel("y",this.yAxisLabel(),i,e)}},{key:"_renderHorizontalGridLinesForAxis",value:function(t,e,i){var n=t.select("g.".concat(pt));if(this._renderHorizontalGridLine){var r=i.tickValues()?i.tickValues():e.ticks?e.ticks.apply(e,i.tickArguments()):e.domain();n.empty()&&(n=t.insert("g",":first-child").attr("class","".concat(vt," ").concat(pt)).attr("transform","translate(".concat(this.margins().left,",").concat(this.margins().top,")")));var s=n.selectAll("line").data(r),a=s.enter().append("line").attr("x1",1).attr("y1",(function(t){return e(t)})).attr("x2",this.xAxisLength()).attr("y2",(function(t){return e(t)})).attr("opacity",0);X(a,this.transitionDuration(),this.transitionDelay()).attr("opacity",.5),X(s,this.transitionDuration(),this.transitionDelay()).attr("x1",1).attr("y1",(function(t){return e(t)})).attr("x2",this.xAxisLength()).attr("y2",(function(t){return e(t)})),s.exit().remove()}else n.selectAll("line").remove()}},{key:"_yAxisX",value:function(){return this.useRightYAxis()?this.width()-this.margins().right:this.margins().left}},{key:"yAxisLabel",value:function(t,e){return arguments.length?(this._yAxisLabel=t,this.margins().left-=this._yAxisLabelPadding,this._yAxisLabelPadding=void 0===e?At:e,this.margins().left+=this._yAxisLabelPadding,this):this._yAxisLabel}},{key:"y",value:function(t){return arguments.length?(this._y=t,this.rescale(),this):this._y}},{key:"yAxis",value:function(t){return arguments.length?(this._yAxis=t,this):(this._yAxis||(this._yAxis=this._createYAxis()),this._yAxis)}},{key:"elasticY",value:function(t){return arguments.length?(this._yElasticity=t,this):this._yElasticity}},{key:"renderHorizontalGridLines",value:function(t){return arguments.length?(this._renderHorizontalGridLine=t,this):this._renderHorizontalGridLine}},{key:"renderVerticalGridLines",value:function(t){return arguments.length?(this._renderVerticalGridLine=t,this):this._renderVerticalGridLine}},{key:"xAxisMin",value:function(){var t=this,e=y.min(this.data(),(function(e){return t.keyAccessor()(e)}));return et.subtract(e,this._xAxisPadding,this._xAxisPaddingUnit)}},{key:"xAxisMax",value:function(){var t=this,e=y.max(this.data(),(function(e){return t.keyAccessor()(e)}));return et.add(e,this._xAxisPadding,this._xAxisPaddingUnit)}},{key:"yAxisMin",value:function(){var t=this,e=y.min(this.data(),(function(e){return t.valueAccessor()(e)}));return et.subtract(e,this._yAxisPadding)}},{key:"yAxisMax",value:function(){var t=this,e=y.max(this.data(),(function(e){return t.valueAccessor()(e)}));return et.add(e,this._yAxisPadding)}},{key:"yAxisPadding",value:function(t){return arguments.length?(this._yAxisPadding=t,this):this._yAxisPadding}},{key:"yAxisHeight",value:function(){return this.effectiveHeight()}},{key:"round",value:function(t){return arguments.length?(this._round=t,this):this._round}},{key:"_rangeBandPadding",value:function(t){return arguments.length?(this._fRangeBandPadding=t,this):this._fRangeBandPadding}},{key:"_outerRangeBandPadding",value:function(t){return arguments.length?(this._fOuterRangeBandPadding=t,this):this._fOuterRangeBandPadding}},{key:"filter",value:function(t){return arguments.length?(r(c(n.prototype),"filter",this).call(this,t),this.redrawBrush(t,!1),this):r(c(n.prototype),"filter",this).call(this)}},{key:"brush",value:function(t){return arguments.length?(this._brush=t,this):this._brush}},{key:"renderBrush",value:function(t,e){var i=this;this._brushOn&&(this._brush.on("start brush end",E.eventHandler((function(t,e){return i._brushing(e)}))),this._gBrush=t.append("g").attr("class","brush").attr("transform","translate(".concat(this.margins().left,",").concat(this.margins().top,")")),this.setBrushExtents(),this.createBrushHandlePaths(this._gBrush,e),this.redrawBrush(this.filter(),e))}},{key:"createBrushHandlePaths",value:function(t){var e=this,i=t.selectAll("path.".concat(bt)).data([{type:"w"},{type:"e"}]);(i=i.enter().append("path").attr("class",bt).merge(i)).attr("d",(function(t){return e.resizeHandlePath(t)}))}},{key:"extendBrush",value:function(t){return t&&this.round()&&(t[0]=this.round()(t[0]),t[1]=this.round()(t[1])),t}},{key:"brushIsEmpty",value:function(t){return!t||t[1]<=t[0]}},{key:"_brushing",value:function(t){var e=this;if(!this._ignoreBrushEvents){var i=t.selection;i&&(i=i.map(this.x().invert)),i=this.extendBrush(i),this.redrawBrush(i,!1);var n=this.brushIsEmpty(i)?null:Q.RangedFilter(i[0],i[1]);J.trigger((function(){e.applyBrushSelection(n)}),B.EVENT_DELAY)}}},{key:"applyBrushSelection",value:function(t){this.replaceFilter(t),this.redrawGroup()}},{key:"_withoutBrushEvents",value:function(t){var e=this._ignoreBrushEvents;this._ignoreBrushEvents=!0;try{t()}finally{this._ignoreBrushEvents=e}}},{key:"setBrushExtents",value:function(t){var e=this;this._withoutBrushEvents((function(){e._brush.extent([[0,0],[e.effectiveWidth(),e.effectiveHeight()]])})),this._gBrush.call(this._brush)}},{key:"redrawBrush",value:function(t,e){var i=this;if(this._brushOn&&this._gBrush)if(this._resizing&&this.setBrushExtents(e),t){var n=[this._x(t[0]),this._x(t[1])],r=j(e,this.transitionDuration(),this.transitionDelay())(this._gBrush);this._withoutBrushEvents((function(){r.call(i._brush.move,n)})),r.selectAll("path.".concat(bt)).attr("display",null).attr("transform",(function(e,n){return"translate(".concat(i._x(t[n]),", 0)")})).attr("d",(function(t){return i.resizeHandlePath(t)}))}else this._withoutBrushEvents((function(){i._gBrush.call(i._brush.move,null)})),this._gBrush.selectAll("path.".concat(bt)).attr("display","none");this.fadeDeselectedArea(t)}},{key:"fadeDeselectedArea",value:function(t){}},{key:"resizeHandlePath",value:function(t){var e=+("e"===(t=t.type)),i=e?1:-1,n=this.effectiveHeight()/3;return"M".concat(.5*i,",").concat(n,"A6,6 0 0 ").concat(e," ").concat(6.5*i,",").concat(n+6,"V").concat(2*n-6,"A6,6 0 0 ").concat(e," ").concat(.5*i,",").concat(2*n,"Z")+"M".concat(2.5*i,",").concat(n+8,"V").concat(2*n-8,"M").concat(4.5*i,",").concat(n+8,"V").concat(2*n-8)}},{key:"_getClipPathId",value:function(){return"".concat(this.anchorName().replace(/[ .#=\[\]"]/g,"-"),"-clip")}},{key:"clipPadding",value:function(t){return arguments.length?(this._clipPadding=t,this):this._clipPadding}},{key:"_generateClipPath",value:function(){var t=et.appendOrSelect(this._parent,"defs"),e=this._getClipPathId(),i=et.appendOrSelect(t,"#".concat(e),"clipPath").attr("id",e),n=2*this._clipPadding;et.appendOrSelect(i,"rect").attr("width",this.xAxisLength()+n).attr("height",this.yAxisHeight()+n).attr("transform","translate(-".concat(this._clipPadding,", -").concat(this._clipPadding,")"))}},{key:"_preprocessData",value:function(){}},{key:"_doRender",value:function(){return this.resetSvg(),this._preprocessData(),this._generateG(),this._generateClipPath(),this._drawChart(!0),this._configureMouseZoom(),this}},{key:"_doRedraw",value:function(){return this._preprocessData(),this._drawChart(!1),this._generateClipPath(),this}},{key:"_drawChart",value:function(t){this.isOrdinal()&&(this._brushOn=!1),this._prepareXAxis(this.g(),t),this._prepareYAxis(this.g()),this.plotData(),(this.elasticX()||this._resizing||t)&&this.renderXAxis(this.g()),(this.elasticY()||this._resizing||t)&&this.renderYAxis(this.g()),t?this.renderBrush(this.g(),!1):this.redrawBrush(this.filter(),this._resizing),this.fadeDeselectedArea(this.filter()),this.resizing(!1)}},{key:"_configureMouseZoom",value:function(){this._origX=this._x.copy(),this._mouseZoomable?this._enableMouseZoom():this._hasBeenMouseZoomable&&this._disableMouseZoom()}},{key:"_enableMouseZoom",value:function(){this._hasBeenMouseZoomable=!0;var t=[[0,0],[this.effectiveWidth(),this.effectiveHeight()]];if(this._zoom.scaleExtent(this._zoomScale).extent(t).duration(this.transitionDuration()),this._zoomOutRestrict){var e=Math.max(this._zoomScale[0],1);this._zoom.translateExtent(t).scaleExtent([e,this._zoomScale[1]])}this.root().call(this._zoom),this._updateD3zoomTransform()}},{key:"_disableMouseZoom",value:function(){this.root().call(this._nullZoom)}},{key:"_zoomHandler",value:function(t,e){var i,n=this;this._hasRangeSelected(t)?(this.x().domain(t),i=Q.RangedFilter(t[0],t[1])):(this.x().domain(this._xOriginalDomain),i=null),this.replaceFilter(i),this.rescale(),this.redraw(),e||(this._rangeChart&&!et.arraysEqual(this.filter(),this._rangeChart.filter())&&J.trigger((function(){n._rangeChart.replaceFilter(i),n._rangeChart.redraw()})),this._invokeZoomedListener(),J.trigger((function(){n.redrawGroup()}),B.EVENT_DELAY))}},{key:"_domainToZoomTransform",value:function(t,e,i){var n=(e[1]-e[0])/(t[1]-t[0]),r=-1*i(t[0]);return x.zoomIdentity.scale(n).translate(r,0)}},{key:"_updateD3zoomTransform",value:function(){var t=this;this._zoom&&this._withoutZoomEvents((function(){t._zoom.transform(t.root(),t._domainToZoomTransform(t.x().domain(),t._xOriginalDomain,t._origX))}))}},{key:"_withoutZoomEvents",value:function(t){var e=this._ignoreZoomEvents;this._ignoreZoomEvents=!0;try{t()}finally{this._ignoreZoomEvents=e}}},{key:"_onZoom",value:function(t){if(!this._ignoreZoomEvents){var e=t.transform.rescaleX(this._origX).domain();this.focus(e,!1)}}},{key:"_checkExtents",value:function(t,e){return t&&2===t.length&&e&&2===e.length?((t[0]>e[1]||t[1]<e[0])&&console.warn("Could not intersect extents, will reset"),[t[0]>e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1]]):t}},{key:"focus",value:function(t,e){this._zoomOutRestrict&&(t=this._checkExtents(t,this._xOriginalDomain),this._rangeChart&&(t=this._checkExtents(t,this._rangeChart.x().domain()))),this._zoomHandler(t,e),this._updateD3zoomTransform()}},{key:"refocused",value:function(){return!et.arraysEqual(this.x().domain(),this._xOriginalDomain)}},{key:"focusChart",value:function(t){var e=this;return arguments.length?(this._focusChart=t,this.on("filtered.dcjs-range-chart",(function(t){t.filter()?et.arraysEqual(t.filter(),e._focusChart.filter())||J.trigger((function(){e._focusChart.focus(t.filter(),!0)})):J.trigger((function(){e._focusChart.x().domain(e._focusChart.xOriginalDomain(),!0)}))})),this):this._focusChart}},{key:"brushOn",value:function(t){return arguments.length?(this._brushOn=t,this):this._brushOn}},{key:"parentBrushOn",value:function(t){return arguments.length?(this._parentBrushOn=t,this):this._parentBrushOn}},{key:"gBrush",value:function(){return this._gBrush}},{key:"_hasRangeSelected",value:function(t){return t instanceof Array&&t.length>1}}]),n}(_t(gt)),St=function(){var t=1,e=1,i=0,n=0,r=null,s=Number,a=wt,l=Lt,o=null,h=!1,c=3,u=.3,d=.8,f=!1,v=!0,p=!1;function m(m){m.each((function(m,x){m=m.map(s).sort(y.ascending);var k,b,A=_.select(this),C=m.length;if(0!==C){var S=m.quartiles=l(m),w=a&&a.call(this,m,x),L=w&&w.map((function(t){return m[t]})),R=w?y.range(0,w[0]).concat(y.range(w[1]+1,C)):y.range(C);v?(k=m[0],b=m[C-1]):(k=m[w[0]],b=m[w[1]]);var D=y.range(w[0],w[1]+1),O=g.scaleLinear().domain(r&&r.call(this,m,x)||[k,b]).range([e,0]),B=this.__chart__||g.scaleLinear().domain([0,1/0]).range(O.range());this.__chart__=O;var F=A.selectAll("line.center").data(L?[L]:[]);F.enter().insert("line","rect").attr("class","center").attr("x1",t/2).attr("y1",(function(t){return B(t[0])})).attr("x2",t/2).attr("y2",(function(t){return B(t[1])})).style("opacity",1e-6).transition().duration(i).delay(n).style("opacity",1).attr("y1",(function(t){return O(t[0])})).attr("y2",(function(t){return O(t[1])})),F.transition().duration(i).delay(n).style("opacity",1).attr("x1",t/2).attr("x2",t/2).attr("y1",(function(t){return O(t[0])})).attr("y2",(function(t){return O(t[1])})),F.exit().transition().duration(i).delay(n).style("opacity",1e-6).attr("y1",(function(t){return O(t[0])})).attr("y2",(function(t){return O(t[1])})).remove();var P=A.selectAll("rect.box").data([S]);P.enter().append("rect").attr("class","box").attr("x",0).attr("y",(function(t){return B(t[2])})).attr("width",t).attr("height",(function(t){return B(t[0])-B(t[2])})).style("fill-opacity",h?.1:1).transition().duration(i).delay(n).attr("y",(function(t){return O(t[2])})).attr("height",(function(t){return O(t[0])-O(t[2])})),P.transition().duration(i).delay(n).attr("width",t).attr("y",(function(t){return O(t[2])})).attr("height",(function(t){return O(t[0])-O(t[2])}));var H=A.selectAll("line.median").data([S[1]]);H.enter().append("line").attr("class","median").attr("x1",0).attr("y1",B).attr("x2",t).attr("y2",B).transition().duration(i).delay(n).attr("y1",O).attr("y2",O),H.transition().duration(i).delay(n).attr("x1",0).attr("x2",t).attr("y1",O).attr("y2",O);var T=A.selectAll("line.whisker").data(L||[]);if(T.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",B).attr("x2",t).attr("y2",B).style("opacity",1e-6).transition().duration(i).delay(n).attr("y1",O).attr("y2",O).style("opacity",1),T.transition().duration(i).delay(n).attr("x1",0).attr("x2",t).attr("y1",O).attr("y2",O).style("opacity",1),T.exit().transition().duration(i).delay(n).attr("y1",O).attr("y2",O).style("opacity",1e-6).remove(),v){var E=p?"outlierBold":"outlier",z=p?3:5,M=p?function(){return Math.floor(Math.random()*(t*d)+1+(t-t*d)/2)}:function(){return t/2},N=A.selectAll("circle.".concat(E)).data(R,Number);N.enter().insert("circle","text").attr("class",E).attr("r",z).attr("cx",M).attr("cy",(function(t){return B(m[t])})).style("opacity",1e-6).transition().duration(i).delay(n).attr("cy",(function(t){return O(m[t])})).style("opacity",.6),f&&(N.selectAll("title").remove(),N.append("title").text((function(t){return m[t]}))),N.transition().duration(i).delay(n).attr("cx",M).attr("cy",(function(t){return O(m[t])})).style("opacity",.6),N.exit().transition().duration(i).delay(n).attr("cy",0).style("opacity",1e-6).remove()}if(h){var G=A.selectAll("circle.data").data(D);G.enter().insert("circle","text").attr("class","data").attr("r",c).attr("cx",(function(){return Math.floor(Math.random()*(t*d)+1+(t-t*d)/2)})).attr("cy",(function(t){return B(m[t])})).style("opacity",1e-6).transition().duration(i).delay(n).attr("cy",(function(t){return O(m[t])})).style("opacity",u),f&&(G.selectAll("title").remove(),G.append("title").text((function(t){return m[t]}))),G.transition().duration(i).delay(n).attr("cx",(function(){return Math.floor(Math.random()*(t*d)+1+(t-t*d)/2)})).attr("cy",(function(t){return O(m[t])})).style("opacity",u),G.exit().transition().duration(i).delay(n).attr("cy",0).style("opacity",1e-6).remove()}var Y=o||O.tickFormat(8),V=A.selectAll("text.box").data(S);V.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",(function(t,e){return 1&e?6:-6})).attr("x",(function(e,i){return 1&i?t:0})).attr("y",B).attr("text-anchor",(function(t,e){return 1&e?"start":"end"})).text(Y).transition().duration(i).delay(n).attr("y",O),V.transition().duration(i).delay(n).text(Y).attr("x",(function(e,i){return 1&i?t:0})).attr("y",O);var I=A.selectAll("text.whisker").data(L||[]);I.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",t).attr("y",B).text(Y).style("opacity",1e-6).transition().duration(i).delay(n).attr("y",O).style("opacity",1),I.transition().duration(i).delay(n).text(Y).attr("x",t).attr("y",O).style("opacity",1),I.exit().transition().duration(i).delay(n).attr("y",O).style("opacity",1e-6).remove(),delete m.quartiles}})),b.timerFlush()}return m.width=function(e){return arguments.length?(t=e,m):t},m.height=function(t){return arguments.length?(e=t,m):e},m.tickFormat=function(t){return arguments.length?(o=t,m):o},m.showOutliers=function(t){return arguments.length?(v=t,m):v},m.boldOutlier=function(t){return arguments.length?(p=t,m):p},m.renderDataPoints=function(t){return arguments.length?(h=t,m):h},m.renderTitle=function(t){return arguments.length?(f=t,m):f},m.dataOpacity=function(t){return arguments.length?(u=t,m):u},m.dataWidthPortion=function(t){return arguments.length?(d=t,m):d},m.duration=function(t){return arguments.length?(i=t,m):i},m.domain=function(t){return arguments.length?(r=null===t||"function"==typeof t?t:et.constant(t),m):r},m.value=function(t){return arguments.length?(s=t,m):s},m.whiskers=function(t){return arguments.length?(a=t,m):a},m.quartiles=function(t){return arguments.length?(l=t,m):l},m};function wt(t){return[0,t.length-1]}function Lt(t){return[y.quantile(t,.25),y.quantile(t,.5),y.quantile(t,.75)]}var Rt=function(t){o(i,t);var e=d(i);function i(){var t;return l(this,i),(t=e.call(this))._stackLayout=A.stack(),t._stack=[],t._titles={},t._hidableStacks=!1,t._evadeDomainFilter=!1,t.data((function(){var e=t._stack.filter(t._visibility);if(!e.length)return[];e.forEach((function(e,i){return t._prepareValues(e,i)}));var i=e[0].values.map((function(t,i){var n={x:t.x};return e.forEach((function(t){n[t.name]=t.values[i].y})),n})),n=e.map((function(t){return t.name}));return t.stackLayout().keys(n)(i).forEach((function(t,i){t.forEach((function(t,n){e[i].values[n].y0=t[0],e[i].values[n].y1=t[1]}))})),e})),t.colorAccessor((function(t){return this.layer||this.name||t.name||t.layer})),t}return a(i,[{key:"_prepareValues",value:function(t,e){var i=this,n=t.accessor||this.valueAccessor();t.name=String(t.name||e);var r=t.group.all().map((function(e,r){return{x:i.keyAccessor()(e,r),y:t.hidden?null:n(e,r),data:e,layer:t.name,hidden:t.hidden}}));t.domainValues=r.filter((function(t){return i._domainFilter()(t)})),t.values=this.evadeDomainFilter()?r:t.domainValues}},{key:"_domainFilter",value:function(){if(!this.x())return et.constant(!0);var t=this.x().domain();return this.isOrdinal()||this.elasticX()?function(){return!0}:function(e){return e.x>=t[0]&&e.x<=t[t.length-1]}}},{key:"stack",value:function(t,e,i){if(!arguments.length)return this._stack;arguments.length<=2&&(i=e);var n={group:t};return"string"==typeof e&&(n.name=e),"function"==typeof i&&(n.accessor=i),this._stack.push(n),this}},{key:"group",value:function(t,e,n){return arguments.length?(this._stack=[],this._titles={},this.stack(t,e),n&&this.valueAccessor(n),r(c(i.prototype),"group",this).call(this,t,e)):r(c(i.prototype),"group",this).call(this)}},{key:"hidableStacks",value:function(t){return arguments.length?(this._hidableStacks=t,this):this._hidableStacks}},{key:"_findLayerByName",value:function(t){var e=this._stack.map(tt("name")).indexOf(t);return this._stack[e]}},{key:"hideStack",value:function(t){var e=this._findLayerByName(t);return e&&(e.hidden=!0),this}},{key:"showStack",value:function(t){var e=this._findLayerByName(t);return e&&(e.hidden=!1),this}},{key:"getValueAccessorByIndex",value:function(t){return this._stack[t].accessor||this.valueAccessor()}},{key:"yAxisMin",value:function(){var t=y.min(this._flattenStack(),(function(t){return t.y<0?t.y+t.y0:t.y0}));return et.subtract(t,this.yAxisPadding())}},{key:"yAxisMax",value:function(){var t=y.max(this._flattenStack(),(function(t){return t.y>0?t.y+t.y0:t.y0}));return et.add(t,this.yAxisPadding())}},{key:"_flattenStack",value:function(){var t,e=this.data().map((function(t){return t.domainValues}));return(t=[]).concat.apply(t,n(e))}},{key:"xAxisMin",value:function(){var t=y.min(this._flattenStack(),tt("x"));return et.subtract(t,this.xAxisPadding(),this.xAxisPaddingUnit())}},{key:"xAxisMax",value:function(){var t=y.max(this._flattenStack(),tt("x"));return et.add(t,this.xAxisPadding(),this.xAxisPaddingUnit())}},{key:"title",value:function(t,e){return t?"function"==typeof t?r(c(i.prototype),"title",this).call(this,t):t===this._groupName&&"function"==typeof e?r(c(i.prototype),"title",this).call(this,e):"function"!=typeof e?this._titles[t]||r(c(i.prototype),"title",this).call(this):(this._titles[t]=e,this):r(c(i.prototype),"title",this).call(this)}},{key:"stackLayout",value:function(t){return arguments.length?(this._stackLayout=t,this):this._stackLayout}},{key:"evadeDomainFilter",value:function(t){return arguments.length?(this._evadeDomainFilter=t,this):this._evadeDomainFilter}},{key:"_visibility",value:function(t){return!t.hidden}},{key:"_ordinalXDomain",value:function(){var t=this._flattenStack().map(tt("data"));return this._computeOrderedGroups(t).map(this.keyAccessor())}},{key:"legendables",value:function(){var t=this;return this._stack.map((function(e,i){return{chart:t,name:e.name,hidden:e.hidden||!1,color:t.getColor.call(e,e.values,i)}}))}},{key:"isLegendableHidden",value:function(t){var e=this._findLayerByName(t.name);return!!e&&e.hidden}},{key:"legendToggle",value:function(t){this._hidableStacks&&(this.isLegendableHidden(t)?this.showStack(t.name):this.hideStack(t.name),this.renderGroup())}}]),i}(Ct),Dt=1,Ot=2,Bt=3,Ft=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._gap=Ot,r._centerBar=!1,r._alwaysUseRounding=!1,r._barWidth=void 0,r.label((function(t){return et.printSingleValue(t.y0+t.y)}),!1),r.anchor(t,n),r}return a(i,[{key:"outerPadding",value:function(t){return arguments.length?this._outerRangeBandPadding(t):this._outerRangeBandPadding()}},{key:"rescale",value:function(){return r(c(i.prototype),"rescale",this).call(this),this._barWidth=void 0,this}},{key:"render",value:function(){return this.round()&&this._centerBar&&!this._alwaysUseRounding&&P.warn("By default, brush rounding is disabled if bars are centered. See dc.js bar chart API documentation for details."),r(c(i.prototype),"render",this).call(this)}},{key:"plotData",value:function(){var t=this.chartBodyG().selectAll("g.stack").data(this.data());this._calculateBarWidth();var e=(t=t.enter().append("g").attr("class",(function(t,e){return"stack _".concat(e)})).merge(t)).size()-1,i=this;t.each((function(t,n){var r=_.select(this);i._renderBars(r,n,t),i.renderLabel()&&e===n&&i._renderLabels(r,n,t)}))}},{key:"_barHeight",value:function(t){return et.safeNumber(Math.abs(this.y()(t.y+t.y0)-this.y()(t.y0)))}},{key:"_labelXPos",value:function(t){var e=this.x()(t.x);return this._centerBar||(e+=this._barWidth/2),this.isOrdinal()&&void 0!==this._gap&&(e+=this._gap/2),et.safeNumber(e)}},{key:"_labelYPos",value:function(t){var e=this.y()(t.y+t.y0);return t.y<0&&(e-=this._barHeight(t)),et.safeNumber(e-Bt)}},{key:"_renderLabels",value:function(t,e,i){var n=this,r=t.selectAll("text.barLabel").data(i.values,tt("x")),s=r.enter().append("text").attr("class","barLabel").attr("text-anchor","middle").attr("x",(function(t){return n._labelXPos(t)})).attr("y",(function(t){return n._labelYPos(t)})).merge(r);this.isOrdinal()&&(s.on("click",E.eventHandler((function(t){return n.onClick(t)}))),s.attr("cursor","pointer")),X(s,this.transitionDuration(),this.transitionDelay()).attr("x",(function(t){return n._labelXPos(t)})).attr("y",(function(t){return n._labelYPos(t)})).text((function(t){return n.label()(t)})),X(r.exit(),this.transitionDuration(),this.transitionDelay()).attr("height",0).remove()}},{key:"_barXPos",value:function(t){var e=this.x()(t.x);return this._centerBar&&(e-=this._barWidth/2),this.isOrdinal()&&void 0!==this._gap&&(e+=this._gap/2),et.safeNumber(e)}},{key:"_renderBars",value:function(t,e,i){var n=this,r=t.selectAll("rect.bar").data(i.values,tt("x")),s=r.enter().append("rect").attr("class","bar").classed("dc-tabbable",this._keyboardAccessible).attr("fill",tt("data",this.getColor)).attr("x",(function(t){return n._barXPos(t)})).attr("y",this.yAxisHeight()).attr("height",0),a=s.merge(r);this.renderTitle()&&s.append("title").text(tt("data",this.title(i.name))),this.isOrdinal()&&a.on("click",E.eventHandler((function(t){return n.onClick(t)}))),this._keyboardAccessible&&this._makeKeyboardAccessible(this.onClick),X(a,this.transitionDuration(),this.transitionDelay()).attr("x",(function(t){return n._barXPos(t)})).attr("y",(function(t){var e=n.y()(t.y+t.y0);return t.y<0&&(e-=n._barHeight(t)),et.safeNumber(e)})).attr("width",this._barWidth).attr("height",(function(t){return n._barHeight(t)})).attr("fill",tt("data",this.getColor)).select("title").text(tt("data",this.title(i.name))),X(r.exit(),this.transitionDuration(),this.transitionDelay()).attr("x",(function(t){return n.x()(t.x)})).attr("width",.9*this._barWidth).remove()}},{key:"_calculateBarWidth",value:function(){if(void 0===this._barWidth){var t=this.xUnitCount();this.isOrdinal()&&void 0===this._gap?this._barWidth=Math.floor(this.x().bandwidth()):this._gap?this._barWidth=Math.floor((this.xAxisLength()-(t-1)*this._gap)/t):this._barWidth=Math.floor(this.xAxisLength()/(1+this.barPadding())/t),(this._barWidth===1/0||isNaN(this._barWidth)||this._barWidth<Dt)&&(this._barWidth=Dt)}}},{key:"fadeDeselectedArea",value:function(t){var e=this,i=this.chartBodyG().selectAll("rect.bar");if(this.isOrdinal())this.hasFilter()?(i.classed(B.SELECTED_CLASS,(function(t){return e.hasFilter(t.x)})),i.classed(B.DESELECTED_CLASS,(function(t){return!e.hasFilter(t.x)}))):(i.classed(B.SELECTED_CLASS,!1),i.classed(B.DESELECTED_CLASS,!1));else if(this.brushOn()||this.parentBrushOn())if(this.brushIsEmpty(t))i.classed(B.DESELECTED_CLASS,!1);else{var n=t[0],r=t[1];i.classed(B.DESELECTED_CLASS,(function(t){return t.x<n||t.x>=r}))}}},{key:"centerBar",value:function(t){return arguments.length?(this._centerBar=t,this):this._centerBar}},{key:"onClick",value:function(t){r(c(i.prototype),"onClick",this).call(this,t.data)}},{key:"barPadding",value:function(t){return arguments.length?(this._rangeBandPadding(t),this._gap=void 0,this):this._rangeBandPadding()}},{key:"_useOuterPadding",value:function(){return void 0===this._gap}},{key:"gap",value:function(t){return arguments.length?(this._gap=t,this):this._gap}},{key:"extendBrush",value:function(t){return t&&this.round()&&(!this._centerBar||this._alwaysUseRounding)&&(t[0]=this.round()(t[0]),t[1]=this.round()(t[1])),t}},{key:"alwaysUseRounding",value:function(t){return arguments.length?(this._alwaysUseRounding=t,this):this._alwaysUseRounding}},{key:"legendHighlight",value:function(t){var e=function(t,e){return function(){var i=_.select(this).attr("fill")===t;return e?!i:i}};this.isLegendableHidden(t)||this.g().selectAll("rect.bar").classed("highlight",e(t.color)).classed("fadeout",e(t.color,!0))}},{key:"legendReset",value:function(){this.g().selectAll("rect.bar").classed("highlight",!1).classed("fadeout",!1)}},{key:"xAxisMax",value:function(){var t=r(c(i.prototype),"xAxisMax",this).call(this);return"resolution"in this.xUnits()&&(t+=this.xUnits().resolution),t}}]),i}(Rt),Pt=function(t,e){return new Ft(t,e)};function Ht(t){return function(e){var i=e.quartiles[0],n=e.quartiles[2],r=(n-i)*t,s=-1,a=e.length;do{++s}while(e[s]<i-r);do{--a}while(e[a]>n+r);return[s,a]}}var Tt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._whiskerIqrFactor=1.5,r._whiskersIqr=Ht,r._whiskers=r._whiskersIqr(r._whiskerIqrFactor),r._box=St(),r._tickFormat=null,r._renderDataPoints=!1,r._dataOpacity=.3,r._dataWidthPortion=.8,r._showOutliers=!0,r._boldOutlier=!1,r._yRangePadding=8,r._boxWidth=function(t,e){return r.isOrdinal()?r.x().bandwidth():t/(1+r.boxPadding())/e},r.x(g.scaleBand()),r.xUnits(st.ordinal),r.data((function(t){return t.all().map((function(t){return t.map=function(e){return e.call(t,t)},t})).filter((function(t){return 0!==r.valueAccessor()(t).length}))})),r.boxPadding(.8),r.outerPadding(.5),r.anchor(t,n),r}return a(i,[{key:"boxPadding",value:function(t){return arguments.length?this._rangeBandPadding(t):this._rangeBandPadding()}},{key:"outerPadding",value:function(t){return arguments.length?this._outerRangeBandPadding(t):this._outerRangeBandPadding()}},{key:"boxWidth",value:function(t){return arguments.length?(this._boxWidth="function"==typeof t?t:et.constant(t),this):this._boxWidth}},{key:"_boxTransform",value:function(t,e){var i=this.x()(this.keyAccessor()(t,e));return"translate(".concat(i,", 0)")}},{key:"_preprocessData",value:function(){this.elasticX()&&this.x().domain([])}},{key:"plotData",value:function(){this._calculatedBoxWidth=this._boxWidth(this.effectiveWidth(),this.xUnitCount()),this._box.whiskers(this._whiskers).width(this._calculatedBoxWidth).height(this.effectiveHeight()).value(this.valueAccessor()).domain(this.y().domain()).duration(this.transitionDuration()).tickFormat(this._tickFormat).renderDataPoints(this._renderDataPoints).dataOpacity(this._dataOpacity).dataWidthPortion(this._dataWidthPortion).renderTitle(this.renderTitle()).showOutliers(this._showOutliers).boldOutlier(this._boldOutlier);var t=this.chartBodyG().selectAll("g.box").data(this.data(),this.keyAccessor()),e=this._renderBoxes(t);this._updateBoxes(e),this._removeBoxes(t),this.fadeDeselectedArea(this.filter())}},{key:"_renderBoxes",value:function(t){var e=this,i=t.enter().append("g");return i.attr("class","box").classed("dc-tabbable",this._keyboardAccessible).attr("transform",(function(t,i){return e._boxTransform(t,i)})).call(this._box).on("click",E.eventHandler((function(t){e.filter(e.keyAccessor()(t)),e.redrawGroup()}))).selectAll("circle").classed("dc-tabbable",this._keyboardAccessible),this._keyboardAccessible&&this._makeKeyboardAccessible(this.onClick),i.merge(t)}},{key:"_updateBoxes",value:function(t){var e=this,i=this;X(t,this.transitionDuration(),this.transitionDelay()).attr("transform",(function(t,i){return e._boxTransform(t,i)})).call(this._box).each((function(t){var e=i.getColor(t,0);_.select(this).select("rect.box").attr("fill",e),_.select(this).selectAll("circle.data").attr("fill",e)}))}},{key:"_removeBoxes",value:function(t){t.exit().remove().call(this._box)}},{key:"_minDataValue",value:function(){var t=this;return y.min(this.data(),(function(e){return y.min(t.valueAccessor()(e))}))}},{key:"_maxDataValue",value:function(){var t=this;return y.max(this.data(),(function(e){return y.max(t.valueAccessor()(e))}))}},{key:"_yAxisRangeRatio",value:function(){return(this._maxDataValue()-this._minDataValue())/this.effectiveHeight()}},{key:"onClick",value:function(t){this.filter(this.keyAccessor()(t)),this.redrawGroup()}},{key:"fadeDeselectedArea",value:function(t){var e=this;if(this.hasFilter())if(this.isOrdinal())this.g().selectAll("g.box").each((function(t){e.isSelectedNode(t)?e.highlightSelected(this):e.fadeDeselected(this)}));else{if(!this.brushOn()&&!this.parentBrushOn())return;var i=t[0],n=t[1];this.g().selectAll("g.box").each((function(t){var r=e.keyAccessor()(t);r<i||r>=n?e.fadeDeselected(this):e.highlightSelected(this)}))}else this.g().selectAll("g.box").each((function(){e.resetHighlight(this)}))}},{key:"isSelectedNode",value:function(t){return this.hasFilter(this.keyAccessor()(t))}},{key:"yAxisMin",value:function(){var t=this._yRangePadding*this._yAxisRangeRatio();return et.subtract(this._minDataValue()-t,this.yAxisPadding())}},{key:"yAxisMax",value:function(){var t=this._yRangePadding*this._yAxisRangeRatio();return et.add(this._maxDataValue()+t,this.yAxisPadding())}},{key:"tickFormat",value:function(t){return arguments.length?(this._tickFormat=t,this):this._tickFormat}},{key:"yRangePadding",value:function(t){return arguments.length?(this._yRangePadding=t,this):this._yRangePadding}},{key:"renderDataPoints",value:function(t){return arguments.length?(this._renderDataPoints=t,this):this._renderDataPoints}},{key:"dataOpacity",value:function(t){return arguments.length?(this._dataOpacity=t,this):this._dataOpacity}},{key:"dataWidthPortion",value:function(t){return arguments.length?(this._dataWidthPortion=t,this):this._dataWidthPortion}},{key:"showOutliers",value:function(t){return arguments.length?(this._showOutliers=t,this):this._showOutliers}},{key:"boldOutlier",value:function(t){return arguments.length?(this._boldOutlier=t,this):this._boldOutlier}}]),i}(Ct),Et=function(t,e){return new Tt(t,e)},zt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this)).transitionDuration(750),r.transitionDelay(0),r.anchor(t,n),r}return a(i,[{key:"_bubbleLocator",value:function(t){return"translate(".concat(this._bubbleX(t),",").concat(this._bubbleY(t),")")}},{key:"plotData",value:function(){this.calculateRadiusDomain(),this.r().range([this.MIN_RADIUS,this.xAxisLength()*this.maxBubbleRelativeSize()]);var t=this.data(),e=this.chartBodyG().selectAll("g.".concat(this.BUBBLE_NODE_CLASS)).data(t,(function(t){return t.key}));(this.sortBubbleSize()||this.keyboardAccessible())&&e.order(),this._removeNodes(e),e=this._renderNodes(e),this._updateNodes(e),this.fadeDeselectedArea(this.filter())}},{key:"_renderNodes",value:function(t){var e=this,i=t.enter().append("g");return i.attr("class",this.BUBBLE_NODE_CLASS).attr("transform",(function(t){return e._bubbleLocator(t)})).append("circle").attr("class",(function(t,i){return"".concat(e.BUBBLE_CLASS," _").concat(i)})).on("click",E.eventHandler((function(t){return e.onClick(t)}))).classed("dc-tabbable",this._keyboardAccessible).attr("fill",this.getColor).attr("r",0),t=i.merge(t),X(t,this.transitionDuration(),this.transitionDelay()).select("circle.".concat(this.BUBBLE_CLASS)).attr("r",(function(t){return e.bubbleR(t)})).attr("opacity",(function(t){return e.bubbleR(t)>0?1:0})),this._keyboardAccessible&&this._makeKeyboardAccessible(this.onClick),this._doRenderLabel(i),this._doRenderTitles(i),t}},{key:"_updateNodes",value:function(t){var e=this;X(t,this.transitionDuration(),this.transitionDelay()).attr("transform",(function(t){return e._bubbleLocator(t)})).select("circle.".concat(this.BUBBLE_CLASS)).attr("fill",this.getColor).attr("r",(function(t){return e.bubbleR(t)})).attr("opacity",(function(t){return e.bubbleR(t)>0?1:0})),this.doUpdateLabels(t),this.doUpdateTitles(t)}},{key:"_removeNodes",value:function(t){t.exit().remove()}},{key:"_bubbleX",value:function(t){var e=this.x()(this.keyAccessor()(t));return!isNaN(e)&&isFinite(e)||(e=0),e}},{key:"_bubbleY",value:function(t){var e=this.y()(this.valueAccessor()(t));return!isNaN(e)&&isFinite(e)||(e=0),e}},{key:"renderBrush",value:function(){}},{key:"redrawBrush",value:function(t,e){this.fadeDeselectedArea(t)}}]),i}(ft(Ct)),Mt=function(t,e){return new zt(t,e)},Nt="bubble-overlay",Gt="node",Yt="bubble",Vt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._g=void 0,r._points=[],r._keyboardAccessible=!1,r.transitionDuration(750),r.transitionDelay(0),r.radiusValueAccessor((function(t){return t.value})),r.anchor(t,n),r}return a(i,[{key:"point",value:function(t,e,i){return this._points.push({name:t,x:e,y:i}),this}},{key:"_doRender",value:function(){return this._g=this._initOverlayG(),this.r().range([this.MIN_RADIUS,this.width()*this.maxBubbleRelativeSize()]),this._initializeBubbles(),this.fadeDeselectedArea(this.filter()),this}},{key:"_initOverlayG",value:function(){return this._g=this.select("g.".concat(Nt)),this._g.empty()&&(this._g=this.svg().append("g").attr("class",Nt)),this._g}},{key:"_initializeBubbles",value:function(){var t=this,e=this._mapData();this.calculateRadiusDomain(),this._points.forEach((function(i){var n=t._getNodeG(i,e),r=n.select("circle.".concat(Yt));r.empty()&&(r=n.append("circle").attr("class",Yt).classed("dc-tabbable",t._keyboardAccessible).attr("r",0).attr("fill",t.getColor).on("click",E.eventHandler((function(e){return t.onClick(e)})))),t._keyboardAccessible&&t._makeKeyboardAccessible(t.onClick),X(r,t.transitionDuration(),t.transitionDelay()).attr("r",(function(e){return t.bubbleR(e)})),t._doRenderLabel(n),t._doRenderTitles(n)}))}},{key:"_mapData",value:function(){var t=this,e={};return this.data().forEach((function(i){e[t.keyAccessor()(i)]=i})),e}},{key:"_getNodeG",value:function(t,e){var i="".concat(Gt," ").concat(et.nameToId(t.name)),n=this._g.select("g.".concat(et.nameToId(t.name)));return n.empty()&&(n=this._g.append("g").attr("class",i).attr("transform","translate(".concat(t.x,",").concat(t.y,")"))),n.datum(e[t.name]),n}},{key:"_doRedraw",value:function(){return this._updateBubbles(),this.fadeDeselectedArea(this.filter()),this}},{key:"_updateBubbles",value:function(){var t=this,e=this._mapData();this.calculateRadiusDomain(),this._points.forEach((function(i){var n=t._getNodeG(i,e),r=n.select("circle.".concat(Yt));X(r,t.transitionDuration(),t.transitionDelay()).attr("r",(function(e){return t.bubbleR(e)})).attr("fill",t.getColor),t.doUpdateLabels(n),t.doUpdateTitles(n)}))}},{key:"debug",value:function(t){if(t){var e=this.select("g.".concat(B.DEBUG_GROUP_CLASS));e.empty()&&(e=this.svg().append("g").attr("class",B.DEBUG_GROUP_CLASS));var i=e.append("text").attr("x",10).attr("y",20);e.append("rect").attr("width",this.width()).attr("height",this.height()).on("mousemove",E.eventHandler((function(t,n){var r=E.pointer(n,e.node()),s="".concat(r[0],", ").concat(r[1]);i.text(s)})))}else this.selectAll(".debug").remove();return this}}]),i}(ft(ut)),It=function(t,e){return new Vt(t,e)},Wt="dc-cbox-group",Ut="dc-cbox-item",Xt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._cbox=void 0,r._promptText="Select all",r._multiple=!1,r._inputType="radio",r._promptValue=null,r._uniqueId=et.uniqueId(),r.data((function(t){return t.all().filter(r._filterDisplayed)})),r._filterDisplayed=function(t){return r.valueAccessor()(t)>0},r._order=function(t,e){return r.keyAccessor()(t)>r.keyAccessor()(e)?1:r.keyAccessor()(t)<r.keyAccessor()(e)?-1:0},r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){return this._doRedraw()}},{key:"_doRedraw",value:function(){var t=this;return this.select("ul").remove(),this._cbox=this.root().append("ul").classed(Wt,!0),this._renderOptions(),this.hasFilter()&&this._multiple?this._cbox.selectAll("input").property("checked",(function(e){return e&&t.filters().indexOf(String(t.keyAccessor()(e)))>=0||!1})):this.hasFilter()&&this._cbox.selectAll("input").property("checked",(function(e){return!!e&&t.keyAccessor()(e)===t.filter()})),this}},{key:"_renderOptions",value:function(){var t=this,e=this._cbox.selectAll("li.".concat(Ut)).data(this.data(),(function(e){return t.keyAccessor()(e)}));e.exit().remove(),(e=e.enter().append("li").classed(Ut,!0).merge(e)).append("input").attr("type",this._inputType).attr("value",(function(e){return t.keyAccessor()(e)})).attr("name","domain_".concat(this._uniqueId)).attr("id",(function(e,i){return"input_".concat(t._uniqueId,"_").concat(i)})),e.append("label").attr("for",(function(e,i){return"input_".concat(t._uniqueId,"_").concat(i)})).text(this.title());var i=this;if(this._multiple)this._cbox.append("li").append("input").attr("type","reset").text(this._promptText).on("click",E.eventHandler((function(t,e){return i._onChange(t,e,this)})));else{var n=this._cbox.append("li");n.append("input").attr("type",this._inputType).attr("value",this._promptValue).attr("name","domain_".concat(this._uniqueId)).attr("id",(function(e,i){return"input_".concat(t._uniqueId,"_all")})).property("checked",!0),n.append("label").attr("for",(function(e,i){return"input_".concat(t._uniqueId,"_all")})).text(this._promptText)}return this._cbox.selectAll("li.".concat(Ut)).sort(this._order),this._cbox.on("change",E.eventHandler((function(t,e){return i._onChange(t,e,this)}))),e}},{key:"_onChange",value:function(t,e,i){var n;_.select(e.target).datum()?(n=_.select(i).selectAll("input").filter((function(t){if(t)return this.checked})).nodes().map((function(t){return t.value})),this._multiple||1!==n.length||(n=n[0])):n=this._promptValue||null,this.onChange(n)}},{key:"onChange",value:function(t){var e=this;t&&this._multiple?this.replaceFilter([t]):t?this.replaceFilter(t):this.filterAll(),J.trigger((function(){e.redrawGroup()}))}},{key:"order",value:function(t){return arguments.length?(this._order=t,this):this._order}},{key:"promptText",value:function(t){return arguments.length?(this._promptText=t,this):this._promptText}},{key:"filterDisplayed",value:function(t){return arguments.length?(this._filterDisplayed=t,this):this._filterDisplayed}},{key:"multiple",value:function(t){return arguments.length?(this._multiple=t,this._multiple?this._inputType="checkbox":this._inputType="radio",this):this._multiple}},{key:"promptValue",value:function(t){return arguments.length?(this._promptValue=t,this):this._promptValue}}]),i}(ut),jt=function(t,e){return new Xt(t,e)},Kt="sub",qt=12,Zt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._children=[],r._childOptions={},r._shareColors=!1,r._shareTitle=!0,r._alignYAxes=!1,r._rightYAxis=m.axisRight(),r._rightYAxisLabel=0,r._rightYAxisLabelPadding=qt,r._rightY=void 0,r._rightAxisGridLines=!1,r._mandatoryAttributes([]),r.transitionDuration(500),r.transitionDelay(0),r.on("filtered.dcjs-composite-chart",(function(t){for(var e=0;e<r._children.length;++e)r._children[e].replaceFilter(r.filter())})),r.anchor(t,n),r}return a(i,[{key:"_generateG",value:function(){for(var t=r(c(i.prototype),"_generateG",this).call(this),e=0;e<this._children.length;++e){var n=this._children[e];this._generateChildG(n,e),n.dimension()||n.dimension(this.dimension()),n.group()||n.group(this.group()),n.chartGroup(this.chartGroup()),n.svg(this.svg()),n.xUnits(this.xUnits()),n.transitionDuration(this.transitionDuration(),this.transitionDelay()),n.parentBrushOn(this.brushOn()),n.brushOn(!1),n.renderTitle(this.renderTitle()),n.elasticX(this.elasticX())}return t}},{key:"rescale",value:function(){return r(c(i.prototype),"rescale",this).call(this),this._children.forEach((function(t){t.rescale()})),this}},{key:"resizing",value:function(t){return arguments.length?(r(c(i.prototype),"resizing",this).call(this,t),this._children.forEach((function(e){e.resizing(t)})),this):r(c(i.prototype),"resizing",this).call(this)}},{key:"_prepareYAxis",value:function(){var t=0!==this._leftYAxisChildren().length,e=0!==this._rightYAxisChildren().length,i=this._calculateYAxisRanges(t,e);t&&this._prepareLeftYAxis(i),e&&this._prepareRightYAxis(i),this._leftYAxisChildren().length>0&&!this._rightAxisGridLines?this._renderHorizontalGridLinesForAxis(this.g(),this.y(),this.yAxis()):this._rightYAxisChildren().length>0&&this._renderHorizontalGridLinesForAxis(this.g(),this._rightY,this._rightYAxis)}},{key:"renderYAxis",value:function(){0!==this._leftYAxisChildren().length&&(this.renderYAxisAt("y",this.yAxis(),this.margins().left),this.renderYAxisLabel("y",this.yAxisLabel(),-90)),0!==this._rightYAxisChildren().length&&(this.renderYAxisAt("yr",this.rightYAxis(),this.width()-this.margins().right),this.renderYAxisLabel("yr",this.rightYAxisLabel(),90,this.width()-this._rightYAxisLabelPadding))}},{key:"_calculateYAxisRanges",value:function(t,e){var i,n,r,s,a;return t&&(i=this._yAxisMin(),n=this._yAxisMax()),e&&(r=this._rightYAxisMin(),s=this._rightYAxisMax()),this.alignYAxes()&&t&&e&&(a=this._alignYAxisRanges(i,n,r,s)),a||{lyAxisMin:i,lyAxisMax:n,ryAxisMin:r,ryAxisMax:s}}},{key:"_alignYAxisRanges",value:function(t,e,i,n){var r=(n-i)/(e-t);return{lyAxisMin:Math.min(t,i/r),lyAxisMax:Math.max(e,n/r),ryAxisMin:Math.min(i,t*r),ryAxisMax:Math.max(n,e*r)}}},{key:"_prepareRightYAxis",value:function(t){var e=void 0===this.rightY()||this.elasticY(),i=e||this.resizing();void 0===this.rightY()&&this.rightY(g.scaleLinear()),e&&this.rightY().domain([t.ryAxisMin,t.ryAxisMax]),i&&this.rightY().rangeRound([this.yAxisHeight(),0]),this.rightY().range([this.yAxisHeight(),0]),this.rightYAxis(this.rightYAxis().scale(this.rightY()))}},{key:"_prepareLeftYAxis",value:function(t){var e=void 0===this.y()||this.elasticY(),i=e||this.resizing();void 0===this.y()&&this.y(g.scaleLinear()),e&&this.y().domain([t.lyAxisMin,t.lyAxisMax]),i&&this.y().rangeRound([this.yAxisHeight(),0]),this.y().range([this.yAxisHeight(),0]),this.yAxis(this.yAxis().scale(this.y()))}},{key:"_generateChildG",value:function(t,e){t._generateG(this.g()),t.g().attr("class","".concat(Kt," _").concat(e))}},{key:"plotData",value:function(){for(var t=0;t<this._children.length;++t){var e=this._children[t];e.g()||this._generateChildG(e,t),this._shareColors&&e.colors(this.colors()),e.x(this.x()),e.xAxis(this.xAxis()),e.useRightYAxis()?(e.y(this.rightY()),e.yAxis(this.rightYAxis())):(e.y(this.y()),e.yAxis(this.yAxis())),e.plotData(),e._activateRenderlets()}}},{key:"useRightAxisGridLines",value:function(t){return arguments?(this._rightAxisGridLines=t,this):this._rightAxisGridLines}},{key:"childOptions",value:function(t){var e=this;return arguments.length?(this._childOptions=t,this._children.forEach((function(t){t.options(e._childOptions)})),this):this._childOptions}},{key:"fadeDeselectedArea",value:function(t){if(this.brushOn())for(var e=0;e<this._children.length;++e)this._children[e].fadeDeselectedArea(t)}},{key:"rightYAxisLabel",value:function(t,e){return arguments.length?(this._rightYAxisLabel=t,this.margins().right-=this._rightYAxisLabelPadding,this._rightYAxisLabelPadding=void 0===e?qt:e,this.margins().right+=this._rightYAxisLabelPadding,this):this._rightYAxisLabel}},{key:"compose",value:function(t){var e=this;return this._children=t,this._children.forEach((function(t){t.height(e.height()),t.width(e.width()),t.margins(e.margins()),e._shareTitle&&t.title(e.title()),t.options(e._childOptions)})),this.rescale(),this}},{key:"_setChildrenProperty",value:function(t,e){this._children.forEach((function(i){i[t](e)}))}},{key:"height",value:function(t){return arguments.length?(r(c(i.prototype),"height",this).call(this,t),this._setChildrenProperty("height",t),this):r(c(i.prototype),"height",this).call(this)}},{key:"width",value:function(t){return arguments.length?(r(c(i.prototype),"width",this).call(this,t),this._setChildrenProperty("width",t),this):r(c(i.prototype),"width",this).call(this)}},{key:"margins",value:function(t){return arguments.length?(r(c(i.prototype),"margins",this).call(this,t),this._setChildrenProperty("margins",t),this):r(c(i.prototype),"margins",this).call(this)}},{key:"children",value:function(){return this._children}},{key:"shareColors",value:function(t){return arguments.length?(this._shareColors=t,this):this._shareColors}},{key:"shareTitle",value:function(t){return arguments.length?(this._shareTitle=t,this):this._shareTitle}},{key:"rightY",value:function(t){return arguments.length?(this._rightY=t,this.rescale(),this):this._rightY}},{key:"alignYAxes",value:function(t){return arguments.length?(this._alignYAxes=t,this.rescale(),this):this._alignYAxes}},{key:"_leftYAxisChildren",value:function(){return this._children.filter((function(t){return!t.useRightYAxis()}))}},{key:"_rightYAxisChildren",value:function(){return this._children.filter((function(t){return t.useRightYAxis()}))}},{key:"_getYAxisMin",value:function(t){return t.map((function(t){return t.yAxisMin()}))}},{key:"_yAxisMin",value:function(){return y.min(this._getYAxisMin(this._leftYAxisChildren()))}},{key:"_rightYAxisMin",value:function(){return y.min(this._getYAxisMin(this._rightYAxisChildren()))}},{key:"_getYAxisMax",value:function(t){return t.map((function(t){return t.yAxisMax()}))}},{key:"_yAxisMax",value:function(){return et.add(y.max(this._getYAxisMax(this._leftYAxisChildren())),this.yAxisPadding())}},{key:"_rightYAxisMax",value:function(){return et.add(y.max(this._getYAxisMax(this._rightYAxisChildren())),this.yAxisPadding())}},{key:"_getAllXAxisMinFromChildCharts",value:function(){return this._children.map((function(t){return t.xAxisMin()}))}},{key:"xAxisMin",value:function(){return et.subtract(y.min(this._getAllXAxisMinFromChildCharts()),this.xAxisPadding(),this.xAxisPaddingUnit())}},{key:"_getAllXAxisMaxFromChildCharts",value:function(){return this._children.map((function(t){return t.xAxisMax()}))}},{key:"xAxisMax",value:function(){return et.add(y.max(this._getAllXAxisMaxFromChildCharts()),this.xAxisPadding(),this.xAxisPaddingUnit())}},{key:"legendables",value:function(){var t=this;return this._children.reduce((function(e,i){return t._shareColors&&i.colors(t.colors()),e.push.apply(e,i.legendables()),e}),[])}},{key:"legendHighlight",value:function(t){for(var e=0;e<this._children.length;++e)this._children[e].legendHighlight(t)}},{key:"legendReset",value:function(t){for(var e=0;e<this._children.length;++e)this._children[e].legendReset(t)}},{key:"legendToggle",value:function(){console.log("composite should not be getting legendToggle itself")}},{key:"rightYAxis",value:function(t){return arguments.length?(this._rightYAxis=t,this):this._rightYAxis}},{key:"yAxisMin",value:function(){throw new Error("Not supported for this chart type")}},{key:"yAxisMax",value:function(){throw new Error("Not supported for this chart type")}}]),i}(Ct),Jt=function(t,e){return new Zt(t,e)},Qt=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._formatNumber=h.format(",d"),r._crossfilter=null,r._groupAll=null,r._html={some:"",all:""},r._mandatoryAttributes(["crossfilter","groupAll"]),r.anchor(t,n),r}return a(i,[{key:"html",value:function(t){return arguments.length?(t.all&&(this._html.all=t.all),t.some&&(this._html.some=t.some),this):this._html}},{key:"formatNumber",value:function(t){return arguments.length?(this._formatNumber=t,this):this._formatNumber}},{key:"_doRender",value:function(){var t=this.crossfilter().size(),e=this.groupAll().value(),i=this._formatNumber(t),n=this._formatNumber(e);return t===e&&""!==this._html.all?this.root().html(this._html.all.replace("%total-count",i).replace("%filter-count",n)):""!==this._html.some?this.root().html(this._html.some.replace("%total-count",i).replace("%filter-count",n)):(this.selectAll(".total-count").text(i),this.selectAll(".filter-count").text(n)),this}},{key:"_doRedraw",value:function(){return this._doRender()}},{key:"crossfilter",value:function(t){return arguments.length?(this._crossfilter=t,this):this._crossfilter}},{key:"dimension",value:function(t){return P.warnOnce("consider using dataCount.crossfilter instead of dataCount.dimension for clarity"),arguments.length?this.crossfilter(t):this.crossfilter()}},{key:"groupAll",value:function(t){return arguments.length?(this._groupAll=t,this):this._groupAll}},{key:"group",value:function(t){return P.warnOnce("consider using dataCount.groupAll instead of dataCount.group for clarity"),arguments.length?this.groupAll(t):this.groupAll()}}]),i}(ut),$t=function(t,e){return new Qt(t,e)},te="dc-grid-label",ee="dc-grid-item",ie="dc-grid-section dc-grid-group",ne="dc-grid-top",re=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._section=null,r._size=999,r._html=function(t){return"you need to provide an html() handling param:  ".concat(JSON.stringify(t))},r._sortBy=function(t){return t},r._order=y.ascending,r._beginSlice=0,r._endSlice=void 0,r._htmlSection=function(t){return"<div class='".concat(ie,"'><h1 class='").concat(te,"'>").concat(r.keyAccessor()(t),"</h1></div>")},r._mandatoryAttributes(["dimension","section"]),r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){return this.selectAll("div.".concat(ne)).remove(),this._renderItems(this._renderSections()),this}},{key:"_renderSections",value:function(){var t=this,e=this.root().selectAll("div.".concat(ne)).data(this._nestEntries(),(function(e){return t.keyAccessor()(e)})),i=e.enter().append("div").attr("class",ne);return this._htmlSection&&i.html((function(e){return t._htmlSection(e)})),e.exit().remove(),i}},{key:"_nestEntries",value:function(){var t=this,e=this.dimension().top(this._size);return e=e.sort((function(e,i){return t._order(t._sortBy(e),t._sortBy(i))})).slice(this._beginSlice,this._endSlice),E.nester({key:this.section(),sortKeys:this._order,entries:e})}},{key:"_renderItems",value:function(t){var e=this,i=t.order().selectAll("div.".concat(ee)).data((function(t){return t.values}));return i.exit().remove(),i=i.enter().append("div").attr("class",ee).html((function(t){return e._html(t)})).merge(i)}},{key:"_doRedraw",value:function(){return this._doRender()}},{key:"section",value:function(t){return arguments.length?(this._section=t,this):this._section}},{key:"group",value:function(t){return P.warnOnce("consider using dataGrid.section instead of dataGrid.group for clarity"),arguments.length?this.section(t):this.section()}},{key:"beginSlice",value:function(t){return arguments.length?(this._beginSlice=t,this):this._beginSlice}},{key:"endSlice",value:function(t){return arguments.length?(this._endSlice=t,this):this._endSlice}},{key:"size",value:function(t){return arguments.length?(this._size=t,this):this._size}},{key:"html",value:function(t){return arguments.length?(this._html=t,this):this._html}},{key:"htmlSection",value:function(t){return arguments.length?(this._htmlSection=t,this):this._htmlSection}},{key:"htmlGroup",value:function(t){return P.warnOnce("consider using dataGrid.htmlSection instead of dataGrid.htmlGroup for clarity"),arguments.length?this.htmlSection(t):this.htmlSection()}},{key:"sortBy",value:function(t){return arguments.length?(this._sortBy=t,this):this._sortBy}},{key:"order",value:function(t){return arguments.length?(this._order=t,this):this._order}}]),i}(ut),se=function(t,e){return new re(t,e)},ae="dc-table-label",le="dc-table-row",oe="dc-table-column",he="dc-table-section dc-table-group",ce="dc-table-head",ue=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._size=25,r._columns=[],r._sortBy=function(t){return t},r._order=y.ascending,r._beginSlice=0,r._endSlice=void 0,r._showSections=!0,r._section=function(){return""},r._mandatoryAttributes(["dimension"]),r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){return this.selectAll("tbody").remove(),this._renderRows(this._renderSections()),this}},{key:"_doColumnValueFormat",value:function(t,e){return"function"==typeof t?t(e):"string"==typeof t?e[t]:t.format(e)}},{key:"_doColumnHeaderFormat",value:function(t){return"function"==typeof t?this._doColumnHeaderFnToString(t):"string"==typeof t?this._doColumnHeaderCapitalize(t):String(t.label)}},{key:"_doColumnHeaderCapitalize",value:function(t){return t.charAt(0).toUpperCase()+t.slice(1)}},{key:"_doColumnHeaderFnToString",value:function(t){var e=String(t),i=e.indexOf("return ");if(i>=0){var n=e.lastIndexOf(";");n>=0&&(e=e.substring(i+7,n)).indexOf("numberFormat")>=0&&(e=e.replace("numberFormat",""))}return e}},{key:"_renderSections",value:function(){var t=this,e=!0;if(this._columns.forEach((function(t){e&="function"==typeof t})),!e){var i=this.selectAll("thead").data([0]);i.exit().remove();var n=(i=i.enter().append("thead").merge(i)).selectAll("tr").data([0]);n.exit().remove();var r=(n=n.enter().append("tr").merge(n)).selectAll("th").data(this._columns);r.exit().remove(),r.enter().append("th").merge(r).attr("class",ce).html((function(e){return t._doColumnHeaderFormat(e)}))}var s=this.root().selectAll("tbody").data(this._nestEntries(),(function(e){return t.keyAccessor()(e)})),a=s.enter().append("tbody");return!0===this._showSections&&a.append("tr").attr("class",he).append("td").attr("class",ae).attr("colspan",this._columns.length).html((function(e){return t.keyAccessor()(e)})),s.exit().remove(),a}},{key:"_nestEntries",value:function(){var t,e=this;return t=(t=this._order===y.ascending?this.dimension().bottom(this._size):this.dimension().top(this._size)).sort((function(t,i){return e._order(e._sortBy(t),e._sortBy(i))})).slice(this._beginSlice,this._endSlice),E.nester({key:this.section(),sortKeys:this._order,entries:t})}},{key:"_renderRows",value:function(t){var e=this,i=t.order().selectAll("tr.".concat(le)).data((function(t){return t.values})),n=i.enter().append("tr").attr("class",le);return this._columns.forEach((function(t,i){n.append("td").attr("class","".concat(oe," _").concat(i)).html((function(i){return e._doColumnValueFormat(t,i)}))})),i.exit().remove(),i}},{key:"_doRedraw",value:function(){return this._doRender()}},{key:"section",value:function(t){return arguments.length?(this._section=t,this):this._section}},{key:"group",value:function(t){return P.warnOnce("consider using dataTable.section instead of dataTable.group for clarity"),arguments.length?this.section(t):this.section()}},{key:"size",value:function(t){return arguments.length?(this._size=t,this):this._size}},{key:"beginSlice",value:function(t){return arguments.length?(this._beginSlice=t,this):this._beginSlice}},{key:"endSlice",value:function(t){return arguments.length?(this._endSlice=t,this):this._endSlice}},{key:"columns",value:function(t){return arguments.length?(this._columns=t,this):this._columns}},{key:"sortBy",value:function(t){return arguments.length?(this._sortBy=t,this):this._sortBy}},{key:"order",value:function(t){return arguments.length?(this._order=t,this):this._order}},{key:"showSections",value:function(t){return arguments.length?(this._showSections=t,this):this._showSections}},{key:"showGroups",value:function(t){return P.warnOnce("consider using dataTable.showSections instead of dataTable.showGroups for clarity"),arguments.length?this.showSections(t):this.showSections()}}]),i}(ut),de=function(t,e){return new ue(t,e)},_e=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this)).colorAccessor((function(t){return t||0})),r._geoPath=C.geoPath(),r._projectionFlag=void 0,r._projection=void 0,r._geoJsons=[],r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){this.resetSvg();for(var t=0;t<this._geoJsons.length;++t){var e=this.svg().append("g").attr("class","layer".concat(t)).selectAll("g.".concat(this._geoJson(t).name)).data(this._geoJson(t).data);(e=e.enter().append("g").attr("class",this._geoJson(t).name).merge(e)).append("path").classed("dc-tabbable",this._keyboardAccessible).attr("fill","white").attr("d",this._getGeoPath()),e.append("title"),this._plotData(t)}this._projectionFlag=!1}},{key:"_plotData",value:function(t){var e=this._generateLayeredData();if(this._isDataLayer(t)){var i=this._renderRegionG(t);this._renderPaths(i,t,e),this._renderTitles(i,t,e)}}},{key:"_generateLayeredData",value:function(){for(var t={},e=this.data(),i=0;i<e.length;++i)t[this.keyAccessor()(e[i])]=this.valueAccessor()(e[i]);return t}},{key:"_isDataLayer",value:function(t){return this._geoJson(t).keyAccessor}},{key:"_renderRegionG",value:function(t){var e=this;return this.svg().selectAll(this._layerSelector(t)).classed("selected",(function(i){return e._isSelected(t,i)})).classed("deselected",(function(i){return e._isDeselected(t,i)})).attr("class",(function(i){var n=e._geoJson(t).name,r=et.nameToId(e._geoJson(t).keyAccessor(i)),s="".concat(n," ").concat(r);return e._isSelected(t,i)&&(s+=" selected"),e._isDeselected(t,i)&&(s+=" deselected"),s}))}},{key:"_layerSelector",value:function(t){return"g.layer".concat(t," g.").concat(this._geoJson(t).name)}},{key:"_isSelected",value:function(t,e){return this.hasFilter()&&this.hasFilter(this._getKey(t,e))}},{key:"_isDeselected",value:function(t,e){return this.hasFilter()&&!this.hasFilter(this._getKey(t,e))}},{key:"_getKey",value:function(t,e){return this._geoJson(t).keyAccessor(e)}},{key:"_geoJson",value:function(t){return this._geoJsons[t]}},{key:"_renderPaths",value:function(t,e,i){var n=this,r=t.select("path").attr("fill",(function(){var t=_.select(this).attr("fill");return t||"none"})).on("click",E.eventHandler((function(t){return n.onClick(t,e)})));this._keyboardAccessible&&this._makeKeyboardAccessible(this.onClick,e),X(r,this.transitionDuration(),this.transitionDelay()).attr("fill",(function(t,r){return n.getColor(i[n._geoJson(e).keyAccessor(t)],r)}))}},{key:"onClick",value:function(t,e){var i=this,n=this._geoJson(e).keyAccessor(t);J.trigger((function(){i.filter(n),i.redrawGroup()}))}},{key:"_renderTitles",value:function(t,e,i){var n=this;this.renderTitle()&&t.selectAll("title").text((function(t){var r=n._getKey(e,t),s=i[r];return n.title()({key:r,value:s})}))}},{key:"_doRedraw",value:function(){for(var t=0;t<this._geoJsons.length;++t)this._plotData(t),this._projectionFlag&&this.svg().selectAll("g.".concat(this._geoJson(t).name," path")).attr("d",this._getGeoPath());this._projectionFlag=!1}},{key:"overlayGeoJson",value:function(t,e,i){for(var n=0;n<this._geoJsons.length;++n)if(this._geoJsons[n].name===e)return this._geoJsons[n].data=t,this._geoJsons[n].keyAccessor=i,this;return this._geoJsons.push({name:e,data:t,keyAccessor:i}),this}},{key:"projection",value:function(t){return arguments.length?(this._projection=t,this._projectionFlag=!0,this):this._projection}},{key:"_getGeoPath",value:function(){return void 0===this._projection?(P.warn("choropleth projection default of geoAlbers is deprecated, in next version projection will need to be set explicitly"),this._geoPath.projection(C.geoAlbersUsa())):this._geoPath.projection(this._projection)}},{key:"geoJsons",value:function(){return this._geoJsons}},{key:"geoPath",value:function(){return this._geoPath}},{key:"removeGeoJson",value:function(t){for(var e=[],i=0;i<this._geoJsons.length;++i){var n=this._geoJsons[i];n.name!==t&&e.push(n)}return this._geoJsons=e,this}}]),i}(_t(ut)),fe=function(t,e){return new _e(t,e)},ye=6.75,ge=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._chartBody=void 0,r._cols=void 0,r._rows=void 0,r._colOrdering=y.ascending,r._rowOrdering=y.ascending,r._colScale=g.scaleBand(),r._rowScale=g.scaleBand(),r._xBorderRadius=ye,r._yBorderRadius=ye,r._mandatoryAttributes(["group"]),r.title(r.colorAccessor()),r._colsLabel=function(t){return t},r._rowsLabel=function(t){return t},r._xAxisOnClick=function(t){r._filterAxis(0,t)},r._yAxisOnClick=function(t){r._filterAxis(1,t)},r._boxOnClick=function(t){var e=t.key;J.trigger((function(){r.filter(Q.TwoDimensionalFilter(e)),r.redrawGroup()}))},r.anchor(t,n),r}return a(i,[{key:"colsLabel",value:function(t){return arguments.length?(this._colsLabel=t,this):this._colsLabel}},{key:"rowsLabel",value:function(t){return arguments.length?(this._rowsLabel=t,this):this._rowsLabel}},{key:"_filterAxis",value:function(t,e){var i=this,n=this.selectAll(".box-group").filter((function(i){return i.key[t]===e})),r=n.filter((function(t){return!i.hasFilter(t.key)}));J.trigger((function(){var t=(r.empty()?n:r).data().map((function(t){return Q.TwoDimensionalFilter(t.key)}));i.filter([t]),i.redrawGroup()}))}},{key:"filter",value:function(t){var e=this,n=function(t){return P.warnOnce("heatmap.filter taking a coordinate is deprecated - please pass dc.filters.TwoDimensionalFilter instead"),e._filter(Q.TwoDimensionalFilter(t))};return arguments.length?null===t||"TwoDimensionalFilter"===t.filterType||Array.isArray(t)&&Array.isArray(t[0])&&"TwoDimensionalFilter"===t[0][0].filterType?r(c(i.prototype),"filter",this).call(this,t):n(t):r(c(i.prototype),"filter",this).call(this)}},{key:"rows",value:function(t){return arguments.length?(this._rows=t,this):this._rows}},{key:"rowOrdering",value:function(t){return arguments.length?(this._rowOrdering=t,this):this._rowOrdering}},{key:"cols",value:function(t){return arguments.length?(this._cols=t,this):this._cols}},{key:"colOrdering",value:function(t){return arguments.length?(this._colOrdering=t,this):this._colOrdering}},{key:"_doRender",value:function(){return this.resetSvg(),this._chartBody=this.svg().append("g").attr("class","heatmap").attr("transform","translate(".concat(this.margins().left,",").concat(this.margins().top,")")),this._doRedraw()}},{key:"_doRedraw",value:function(){var t=this,e=this.data(),i=this.rows()||e.map(this.valueAccessor()),n=this.cols()||e.map(this.keyAccessor());this._rowOrdering&&(i=i.sort(this._rowOrdering)),this._colOrdering&&(n=n.sort(this._colOrdering)),i=this._rowScale.domain(i),n=this._colScale.domain(n);var r=i.domain().length,s=n.domain().length,a=Math.floor(this.effectiveWidth()/s),l=Math.floor(this.effectiveHeight()/r);n.rangeRound([0,this.effectiveWidth()]),i.rangeRound([this.effectiveHeight(),0]);var o=this._chartBody.selectAll("g.box-group").data(this.data(),(function(e,i){return"".concat(t.keyAccessor()(e,i),"\0").concat(t.valueAccessor()(e,i))}));o.exit().remove();var h=o.enter().append("g").attr("class","box-group");h.append("rect").attr("class","heat-box").classed("dc-tabbable",this._keyboardAccessible).attr("fill","white").attr("x",(function(e,i){return n(t.keyAccessor()(e,i))})).attr("y",(function(e,n){return i(t.valueAccessor()(e,n))})).on("click",E.eventHandler(this.boxOnClick())),this._keyboardAccessible&&this._makeKeyboardAccessible(this.boxOnClick),o=h.merge(o),this.renderTitle()&&(h.append("title"),o.select("title").text(this.title())),X(o.select("rect"),this.transitionDuration(),this.transitionDelay()).attr("x",(function(e,i){return n(t.keyAccessor()(e,i))})).attr("y",(function(e,n){return i(t.valueAccessor()(e,n))})).attr("rx",this._xBorderRadius).attr("ry",this._yBorderRadius).attr("fill",this.getColor).attr("width",a).attr("height",l);var c=this._chartBody.select("g.cols");c.empty()&&(c=this._chartBody.append("g").attr("class","cols axis"));var u=c.selectAll("text").data(n.domain());u.exit().remove(),u=u.enter().append("text").attr("x",(function(t){return n(t)+a/2})).style("text-anchor","middle").attr("y",this.effectiveHeight()).attr("dy",12).on("click",E.eventHandler(this.xAxisOnClick())).text(this.colsLabel()).merge(u),X(u,this.transitionDuration(),this.transitionDelay()).text(this.colsLabel()).attr("x",(function(t){return n(t)+a/2})).attr("y",this.effectiveHeight());var d=this._chartBody.select("g.rows");d.empty()&&(d=this._chartBody.append("g").attr("class","rows axis"));var _=d.selectAll("text").data(i.domain());if(_.exit().remove(),_=_.enter().append("text").style("text-anchor","end").attr("x",0).attr("dx",-2).attr("y",(function(t){return i(t)+l/2})).attr("dy",6).on("click",E.eventHandler(this.yAxisOnClick())).text(this.rowsLabel()).merge(_),X(_,this.transitionDuration(),this.transitionDelay()).text(this.rowsLabel()).attr("y",(function(t){return i(t)+l/2})),this.hasFilter()){var f=this;this.selectAll("g.box-group").each((function(t){f.isSelectedNode(t)?f.highlightSelected(this):f.fadeDeselected(this)}))}else{var y=this;this.selectAll("g.box-group").each((function(){y.resetHighlight(this)}))}return this}},{key:"boxOnClick",value:function(t){return arguments.length?(this._boxOnClick=t,this):this._boxOnClick}},{key:"xAxisOnClick",value:function(t){return arguments.length?(this._xAxisOnClick=t,this):this._xAxisOnClick}},{key:"yAxisOnClick",value:function(t){return arguments.length?(this._yAxisOnClick=t,this):this._yAxisOnClick}},{key:"xBorderRadius",value:function(t){return arguments.length?(this._xBorderRadius=t,this):this._xBorderRadius}},{key:"yBorderRadius",value:function(t){return arguments.length?(this._yBorderRadius=t,this):this._yBorderRadius}},{key:"isSelectedNode",value:function(t){return this.hasFilter(t.key)}}]),i}(_t(gt)),ve=function(t,e){return new ge(t,e)},pe=function(){function t(){l(this,t),this._htmlLegendDivCssClass="dc-html-legend",this._legendItemCssClassHorizontal="dc-legend-item-horizontal",this._legendItemCssClassVertical="dc-legend-item-vertical",this._parent=void 0,this._container=void 0,this._legendText=tt("name"),this._maxItems=void 0,this._horizontal=!1,this._legendItemClass=void 0,this._highlightSelected=!1,this._keyboardAccessible=!1}return a(t,[{key:"parent",value:function(t){return arguments.length?(this._parent=t,this):this._parent}},{key:"render",value:function(){var t=this;this._defaultLegendItemCssClass=this._horizontal?this._legendItemCssClassHorizontal:this._legendItemCssClassVertical,this._container.select("div.".concat(this._htmlLegendDivCssClass)).remove();var e=this._container.append("div").attr("class",this._htmlLegendDivCssClass);e.attr("style","max-width:".concat(this._container.nodes()[0].style.width));var i=this._parent.legendables(),n=this._parent.filters();void 0!==this._maxItems&&(i=i.slice(0,this._maxItems));var r=this._legendItemClass?this._legendItemClass:this._defaultLegendItemCssClass,s=e.selectAll("div.".concat(r)).data(i).enter().append("div").classed(r,!0).on("mouseover",E.eventHandler((function(e){return t._parent.legendHighlight(e)}))).on("mouseout",E.eventHandler((function(e){return t._parent.legendReset(e)}))).on("click",E.eventHandler((function(e){return t._parent.legendToggle(e)})));this._highlightSelected&&s.classed(B.SELECTED_CLASS,(function(t){return-1!==n.indexOf(t.name)})),s.append("span").attr("class","dc-legend-item-color").style("background-color",tt("color")),s.append("span").attr("class","dc-legend-item-label").classed("dc-tabbable",this._keyboardAccessible).attr("title",this._legendText).text(this._legendText),this._keyboardAccessible&&this._makeLegendKeyboardAccessible()}},{key:"container",value:function(t){return arguments.length?(this._container=_.select(t),this):this._container}},{key:"legendItemClass",value:function(t){return arguments.length?(this._legendItemClass=t,this):this._legendItemClass}},{key:"highlightSelected",value:function(t){return arguments.length?(this._highlightSelected=t,this):this._highlightSelected}},{key:"horizontal",value:function(t){return arguments.length?(this._horizontal=t,this):this._horizontal}},{key:"legendText",value:function(t){return arguments.length?(this._legendText=t,this):this._legendText}},{key:"maxItems",value:function(t){return arguments.length?(this._maxItems=et.isNumber(t)?t:void 0,this):this._maxItems}},{key:"keyboardAccessible",value:function(t){return arguments.length?(this._keyboardAccessible=t,this):this._keyboardAccessible}},{key:"_makeLegendKeyboardAccessible",value:function(){var t=this;this._parent._svgDescription||(this._parent.svg().append("desc").attr("id","desc-id-".concat(this._parent.__dcFlag__)).html("".concat(this._parent.svgDescription())),this._parent.svg().attr("tabindex","0").attr("role","img").attr("aria-labelledby","desc-id-".concat(this._parent.__dcFlag__))),this.container().selectAll(".dc-legend-item-label.dc-tabbable").attr("tabindex",0).on("keydown",E.eventHandler((function(t,e){13===e.keyCode&&"object"==typeof t&&t.chart.legendToggle(t),32===e.keyCode&&"object"==typeof t&&(t.chart.legendToggle(t),e.preventDefault())}))).on("focus",E.eventHandler((function(e){t._parent.legendHighlight(e)}))).on("blur",E.eventHandler((function(e){t._parent.legendReset(e)})))}}]),t}(),me=function(){return new pe},xe=2,ke=function(){function t(){l(this,t),this._parent=void 0,this._x=0,this._y=0,this._itemHeight=12,this._gap=5,this._horizontal=!1,this._legendWidth=560,this._itemWidth=70,this._autoItemWidth=!1,this._legendText=tt("name"),this._maxItems=void 0,this._highlightSelected=!1,this._keyboardAccessible=!1,this._g=void 0}return a(t,[{key:"parent",value:function(t){return arguments.length?(this._parent=t,this):this._parent}},{key:"x",value:function(t){return arguments.length?(this._x=t,this):this._x}},{key:"y",value:function(t){return arguments.length?(this._y=t,this):this._y}},{key:"gap",value:function(t){return arguments.length?(this._gap=t,this):this._gap}},{key:"highlightSelected",value:function(t){return arguments.length?(this._highlightSelected=t,this):this._highlightSelected}},{key:"itemHeight",value:function(t){return arguments.length?(this._itemHeight=t,this):this._itemHeight}},{key:"horizontal",value:function(t){return arguments.length?(this._horizontal=t,this):this._horizontal}},{key:"legendWidth",value:function(t){return arguments.length?(this._legendWidth=t,this):this._legendWidth}},{key:"itemWidth",value:function(t){return arguments.length?(this._itemWidth=t,this):this._itemWidth}},{key:"autoItemWidth",value:function(t){return arguments.length?(this._autoItemWidth=t,this):this._autoItemWidth}},{key:"legendText",value:function(t){return arguments.length?(this._legendText=t,this):this._legendText}},{key:"maxItems",value:function(t){return arguments.length?(this._maxItems=et.isNumber(t)?t:void 0,this):this._maxItems}},{key:"keyboardAccessible",value:function(t){return arguments.length?(this._keyboardAccessible=t,this):this._keyboardAccessible}},{key:"_legendItemHeight",value:function(){return this._gap+this._itemHeight}},{key:"_makeLegendKeyboardAccessible",value:function(){var t=this;this._parent._svgDescription||(this._parent.svg().append("desc").attr("id","desc-id-".concat(this._parent.__dcFlag__)).html("".concat(this._parent.svgDescription())),this._parent.svg().attr("tabindex","0").attr("role","img").attr("aria-labelledby","desc-id-".concat(this._parent.__dcFlag__))),this._parent.svg().selectAll(".dc-legend .dc-tabbable").attr("tabindex",0).on("keydown",E.eventHandler((function(t,e){13===e.keyCode&&"object"==typeof t&&t.chart.legendToggle(t),32===e.keyCode&&"object"==typeof t&&(t.chart.legendToggle(t),e.preventDefault())}))).on("focus",E.eventHandler((function(e){t._parent.legendHighlight(e)}))).on("blur",E.eventHandler((function(e){t._parent.legendReset(e)})))}},{key:"render",value:function(){var t=this;this._parent.svg().select("g.dc-legend").remove(),this._g=this._parent.svg().append("g").attr("class","dc-legend").attr("transform","translate(".concat(this._x,",").concat(this._y,")"));var e=this._parent.legendables(),i=this._parent.filters();void 0!==this._maxItems&&(e=e.slice(0,this._maxItems));var n=this._g.selectAll("g.dc-legend-item").data(e).enter().append("g").attr("class","dc-legend-item").on("mouseover",E.eventHandler((function(e){t._parent.legendHighlight(e)}))).on("mouseout",E.eventHandler((function(e){t._parent.legendReset(e)}))).on("click",E.eventHandler((function(t){t.chart.legendToggle(t)})));this._highlightSelected&&n.classed(B.SELECTED_CLASS,(function(t){return-1!==i.indexOf(t.name)})),this._g.selectAll("g.dc-legend-item").classed("fadeout",(function(t){return t.chart.isLegendableHidden(t)})),e.some(tt("dashstyle"))?n.append("line").attr("x1",0).attr("y1",this._itemHeight/2).attr("x2",this._itemHeight).attr("y2",this._itemHeight/2).attr("stroke-width",2).attr("stroke-dasharray",tt("dashstyle")).attr("stroke",tt("color")):n.append("rect").attr("width",this._itemHeight).attr("height",this._itemHeight).attr("fill",(function(t){return t?t.color:"blue"}));var r=this;n.append("text").text(r._legendText).classed("dc-tabbable",this._keyboardAccessible).attr("x",r._itemHeight+xe).attr("y",(function(){return r._itemHeight/2+(this.clientHeight?this.clientHeight:13)/2-2})),this._keyboardAccessible&&this._makeLegendKeyboardAccessible();var s=0,a=0,l=this;n.attr("transform",(function(t,e){if(l._horizontal){var i=!0===l._autoItemWidth?this.getBBox().width+l._gap:l._itemWidth;s+i>l._legendWidth&&s>0&&(++a,s=0);var n="translate(".concat(s,",").concat(a*l._legendItemHeight(),")");return s+=i,n}return"translate(0,".concat(e*l._legendItemHeight(),")")}))}}]),t}(),be=function(){return new ke},Ae=5,Ce="dc-tooltip",Se="dot",we="yRef",Le="xRef",Re=1e-6,De=3,Oe=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._renderArea=!1,r._dotRadius=Ae,r._dataPointRadius=null,r._dataPointFillOpacity=Re,r._dataPointStrokeOpacity=Re,r._curve=null,r._interpolate=null,r._tension=null,r._defined=void 0,r._dashStyle=void 0,r._xyTipsOn=!0,r.transitionDuration(500),r.transitionDelay(0),r._rangeBandPadding(1),r.label((function(t){return et.printSingleValue(t.y0+t.y)}),!1),r.anchor(t,n),r}return a(i,[{key:"plotData",value:function(){var t=this.chartBodyG(),e=t.select("g.stack-list");e.empty()&&(e=t.append("g").attr("class","stack-list"));var i=e.selectAll("g.stack").data(this.data()),n=i.enter().append("g").attr("class",(function(t,e){return"stack _".concat(e)}));i=n.merge(i),this._drawLine(n,i),this._drawArea(n,i),this._drawDots(t,i),this.renderLabel()&&this._drawLabels(i)}},{key:"curve",value:function(t){return arguments.length?(this._curve=t,this):this._curve}},{key:"interpolate",value:function(t){return P.warnOnce("dc.lineChart.interpolate has been deprecated since version 3.0 use dc.lineChart.curve instead"),arguments.length?(this._interpolate=t,this):this._interpolate}},{key:"tension",value:function(t){return P.warnOnce("dc.lineChart.tension has been deprecated since version 3.0 use dc.lineChart.curve instead"),arguments.length?(this._tension=t,this):this._tension}},{key:"defined",value:function(t){return arguments.length?(this._defined=t,this):this._defined}},{key:"dashStyle",value:function(t){return arguments.length?(this._dashStyle=t,this):this._dashStyle}},{key:"renderArea",value:function(t){return arguments.length?(this._renderArea=t,this):this._renderArea}},{key:"_getColor",value:function(t,e){return this.getColor.call(t,t.values,e)}},{key:"_getCurveFactory",value:function(){var t=null;return this._curve?this._curve:((t="function"==typeof this._interpolate?this._interpolate:{linear:A.curveLinear,"linear-closed":A.curveLinearClosed,step:A.curveStep,"step-before":A.curveStepBefore,"step-after":A.curveStepAfter,basis:A.curveBasis,"basis-open":A.curveBasisOpen,"basis-closed":A.curveBasisClosed,bundle:A.curveBundle,cardinal:A.curveCardinal,"cardinal-open":A.curveCardinalOpen,"cardinal-closed":A.curveCardinalClosed,monotone:A.curveMonotoneX}[this._interpolate])||(t=A.curveLinear),null!==this._tension&&("function"!=typeof t.tension?P.warn("tension was specified but the curve/interpolate does not support it."):t=t.tension(this._tension)),t)}},{key:"_drawLine",value:function(t,e){var i=this,n=A.line().x((function(t){return i.x()(t.x)})).y((function(t){return i.y()(t.y+t.y0)})).curve(this._getCurveFactory());this._defined&&n.defined(this._defined);var r=t.append("path").attr("class","line").attr("stroke",(function(t,e){return i._getColor(t,e)}));this._dashStyle&&r.attr("stroke-dasharray",this._dashStyle),X(e.select("path.line"),this.transitionDuration(),this.transitionDelay()).attr("stroke",(function(t,e){return i._getColor(t,e)})).attr("d",(function(t){return i._safeD(n(t.values))}))}},{key:"_drawArea",value:function(t,e){var i=this;if(this._renderArea){var n=A.area().x((function(t){return i.x()(t.x)})).y1((function(t){return i.y()(t.y+t.y0)})).y0((function(t){return i.y()(t.y0)})).curve(this._getCurveFactory());this._defined&&n.defined(this._defined),t.append("path").attr("class","area").attr("fill",(function(t,e){return i._getColor(t,e)})).attr("d",(function(t){return i._safeD(n(t.values))})),X(e.select("path.area"),this.transitionDuration(),this.transitionDelay()).attr("fill",(function(t,e){return i._getColor(t,e)})).attr("d",(function(t){return i._safeD(n(t.values))}))}}},{key:"_safeD",value:function(t){return!t||t.indexOf("NaN")>=0?"M0,0":t}},{key:"_drawDots",value:function(t,e){var i=this;if("always"===this.xyTipsOn()||!this.brushOn()&&!this.parentBrushOn()&&this.xyTipsOn()){var n="".concat(Ce,"-list"),r=t.select("g.".concat(n));r.empty()&&(r=t.append("g").attr("class",n)),e.each((function(t,e){var n=t.values;i._defined&&(n=n.filter(i._defined));var s=r.select("g.".concat(Ce,"._").concat(e));s.empty()&&(s=r.append("g").attr("class","".concat(Ce," _").concat(e))),i._createRefLines(s);var a=s.selectAll("circle.".concat(Se)).data(n,tt("x")),l=i,o=a.enter().append("circle").attr("class",Se).classed("dc-tabbable",i._keyboardAccessible).attr("cx",(function(t){return et.safeNumber(i.x()(t.x))})).attr("cy",(function(t){return et.safeNumber(i.y()(t.y+t.y0))})).attr("r",i._getDotRadius()).style("fill-opacity",i._dataPointFillOpacity).style("stroke-opacity",i._dataPointStrokeOpacity).attr("fill",i.getColor).attr("stroke",i.getColor).on("mousemove",(function(){var t=_.select(this);l._showDot(t),l._showRefLines(t,s)})).on("mouseout",(function(){var t=_.select(this);l._hideDot(t),l._hideRefLines(s)})).merge(a);i._keyboardAccessible&&i._svg.selectAll(".dc-tabbable").attr("tabindex",0).on("focus",(function(){var t=_.select(this);l._showDot(t),l._showRefLines(t,s)})).on("blur",(function(){var t=_.select(this);l._hideDot(t),l._hideRefLines(s)})),o.call((function(e){return i._doRenderTitle(e,t)})),X(o,i.transitionDuration()).attr("cx",(function(t){return et.safeNumber(i.x()(t.x))})).attr("cy",(function(t){return et.safeNumber(i.y()(t.y+t.y0))})).attr("fill",i.getColor),a.exit().remove()}))}}},{key:"_drawLabels",value:function(t){var e=this;t.each((function(t,i){var n=_.select(this).selectAll("text.lineLabel").data(t.values,tt("x")),r=n.enter().append("text").attr("class","lineLabel").attr("text-anchor","middle").merge(n);X(r,e.transitionDuration()).attr("x",(function(t){return et.safeNumber(e.x()(t.x))})).attr("y",(function(t){var i=e.y()(t.y+t.y0)-De;return et.safeNumber(i)})).text((function(t){return e.label()(t)})),X(n.exit(),e.transitionDuration()).attr("height",0).remove()}))}},{key:"_createRefLines",value:function(t){(t.select("path.".concat(we)).empty()?t.append("path").attr("class",we):t.select("path.".concat(we))).style("display","none").attr("stroke-dasharray","5,5"),(t.select("path.".concat(Le)).empty()?t.append("path").attr("class",Le):t.select("path.".concat(Le))).style("display","none").attr("stroke-dasharray","5,5")}},{key:"_showDot",value:function(t){return t.style("fill-opacity",.8),t.style("stroke-opacity",.8),t.attr("r",this._dotRadius),t}},{key:"_showRefLines",value:function(t,e){var i=t.attr("cx"),n=t.attr("cy"),r=this._yAxisX()-this.margins().left,s="M".concat(r," ").concat(n,"L").concat(i," ").concat(n),a="M".concat(i," ").concat(this.yAxisHeight(),"L").concat(i," ").concat(n);e.select("path.".concat(we)).style("display","").attr("d",s),e.select("path.".concat(Le)).style("display","").attr("d",a)}},{key:"_getDotRadius",value:function(){return this._dataPointRadius||this._dotRadius}},{key:"_hideDot",value:function(t){t.style("fill-opacity",this._dataPointFillOpacity).style("stroke-opacity",this._dataPointStrokeOpacity).attr("r",this._getDotRadius())}},{key:"_hideRefLines",value:function(t){t.select("path.".concat(we)).style("display","none"),t.select("path.".concat(Le)).style("display","none")}},{key:"_doRenderTitle",value:function(t,e){this.renderTitle()&&(t.select("title").remove(),t.append("title").text(tt("data",this.title(e.name))))}},{key:"xyTipsOn",value:function(t){return arguments.length?(this._xyTipsOn=t,this):this._xyTipsOn}},{key:"dotRadius",value:function(t){return arguments.length?(this._dotRadius=t,this):this._dotRadius}},{key:"renderDataPoints",value:function(t){return arguments.length?(t?(this._dataPointFillOpacity=t.fillOpacity||.8,this._dataPointStrokeOpacity=t.strokeOpacity||0,this._dataPointRadius=t.radius||2):(this._dataPointFillOpacity=Re,this._dataPointStrokeOpacity=Re,this._dataPointRadius=null),this):{fillOpacity:this._dataPointFillOpacity,strokeOpacity:this._dataPointStrokeOpacity,radius:this._dataPointRadius}}},{key:"_colorFilter",value:function(t,e,i){return function(){var n=_.select(this),r=n.attr("stroke")===t&&n.attr("stroke-dasharray")===(e instanceof Array?e.join(","):null)||n.attr("fill")===t;return i?!r:r}}},{key:"legendHighlight",value:function(t){this.isLegendableHidden(t)||this.g().selectAll("path.line, path.area").classed("highlight",this._colorFilter(t.color,t.dashstyle)).classed("fadeout",this._colorFilter(t.color,t.dashstyle,!0))}},{key:"legendReset",value:function(){this.g().selectAll("path.line, path.area").classed("highlight",!1).classed("fadeout",!1)}},{key:"legendables",value:function(){var t=this,e=r(c(i.prototype),"legendables",this).call(this);return this._dashStyle?e.map((function(e){return e.dashstyle=t._dashStyle,e})):e}}]),i}(Rt),Be=function(t,e){return new Oe(t,e)},Fe="number-display",Pe=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._formatNumber=h.format(".2s"),r._html={one:"",some:"",none:""},r._lastValue=void 0,r._ariaLiveRegion=!1,r._mandatoryAttributes(["group"]),r.ordering((function(t){return t.value})),r.data((function(t){var e=t.value?t.value():r._maxBin(t.all());return r.valueAccessor()(e)})),r.transitionDuration(250),r.transitionDelay(0),r.anchor(t,n),r}return a(i,[{key:"html",value:function(t){return arguments.length?(t.none?this._html.none=t.none:t.one?this._html.none=t.one:t.some&&(this._html.none=t.some),t.one?this._html.one=t.one:t.some&&(this._html.one=t.some),t.some?this._html.some=t.some:t.one&&(this._html.some=t.one),this):this._html}},{key:"value",value:function(){return this.data()}},{key:"_maxBin",value:function(t){if(!t.length)return null;var e=this._computeOrderedGroups(t);return e[e.length-1]}},{key:"_doRender",value:function(){var t=this.value(),e=this.selectAll(".".concat(Fe));e.empty()&&(e=e.data([0]).enter().append("span").attr("class",Fe).classed("dc-tabbable",this._keyboardAccessible).merge(e),this._keyboardAccessible&&e.attr("tabindex","0"),this._ariaLiveRegion&&(this.transitionDuration(0),e.attr("aria-live","polite")));var i=this;e.transition().duration(i.transitionDuration()).delay(i.transitionDelay()).ease(S.easeQuad).tween("text",(function(){var e=isFinite(i._lastValue)?i._lastValue:0,n=v.interpolateNumber(e||0,t);i._lastValue=t;var r=this;return function(e){var s=null,a=i.formatNumber()(n(e));0===t&&""!==i._html.none?s=i._html.none:1===t&&""!==i._html.one?s=i._html.one:""!==i._html.some&&(s=i._html.some),r.innerHTML=s?s.replace("%number",a):a}}))}},{key:"_doRedraw",value:function(){return this._doRender()}},{key:"formatNumber",value:function(t){return arguments.length?(this._formatNumber=t,this):this._formatNumber}},{key:"ariaLiveRegion",value:function(t){return arguments.length?(this._ariaLiveRegion=t,this):this._ariaLiveRegion}}]),i}(ut),He=function(t,e){return new Pe(t,e)},Te=.5,Ee=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._sliceCssClass="pie-slice",r._labelCssClass="pie-label",r._sliceGroupCssClass="pie-slice-group",r._labelGroupCssClass="pie-label-group",r._emptyCssClass="empty-chart",r._emptyTitle="empty",r._radius=void 0,r._givenRadius=void 0,r._innerRadius=0,r._externalRadiusPadding=0,r._g=void 0,r._cx=void 0,r._cy=void 0,r._minAngleForLabel=Te,r._externalLabelRadius=void 0,r._drawPaths=!1,r.colorAccessor((function(t){return r.cappedKeyAccessor(t)})),r.title((function(t){return"".concat(r.cappedKeyAccessor(t),": ").concat(r.cappedValueAccessor(t))})),r.label((function(t){return r.cappedKeyAccessor(t)})),r.renderLabel(!0),r.transitionDuration(350),r.transitionDelay(0),r.anchor(t,n),r}return a(i,[{key:"slicesCap",value:function(t){return this.cap(t)}},{key:"_doRender",value:function(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform","translate(".concat(this.cx(),",").concat(this.cy(),")")),this._g.append("g").attr("class",this._sliceGroupCssClass),this._g.append("g").attr("class",this._labelGroupCssClass),this._drawChart(),this}},{key:"_drawChart",value:function(){var t=this,e=y.min([this.width(),this.height()])/2;this._radius=this._givenRadius&&this._givenRadius<e?this._givenRadius:e;var i,n=this._buildArcs(),r=this._pieLayout();if(y.sum(this.data(),(function(e){return t.cappedValueAccessor(e)}))?(i=r(this.data()),this._g.classed(this._emptyCssClass,!1)):(i=r([{key:this._emptyTitle,value:1,others:[this._emptyTitle]}]),this._g.classed(this._emptyCssClass,!0)),this._g){var s=this._g.select("g.".concat(this._sliceGroupCssClass)).selectAll("g.".concat(this._sliceCssClass)).data(i),a=this._g.select("g.".concat(this._labelGroupCssClass)).selectAll("text.".concat(this._labelCssClass)).data(i);this._removeElements(s,a),this._createElements(s,a,n,i),this._updateElements(i,n),this._highlightFilter(),X(this._g,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(this.cx(),",").concat(this.cy(),")"))}}},{key:"_createElements",value:function(t,e,i,n){var r=this._createSliceNodes(t);this._createSlicePath(r,i),this._createTitles(r),this._createLabels(e,n,i)}},{key:"_createSliceNodes",value:function(t){var e=this;return t.enter().append("g").attr("class",(function(t,i){return"".concat(e._sliceCssClass," _").concat(i)})).classed("dc-tabbable",this._keyboardAccessible)}},{key:"_createSlicePath",value:function(t,e){var i=this,n=t.append("path").attr("fill",(function(t,e){return i._fill(t,e)})).on("click",E.eventHandler((function(t){return i._onClick(t)}))).attr("d",(function(t,n){return i._safeArc(t,n,e)}));this._keyboardAccessible&&this._makeKeyboardAccessible(this._onClick);var r=X(n,this.transitionDuration(),this.transitionDelay());if(r.attrTween){var s=this;r.attrTween("d",(function(t){return s._tweenPie(t,this)}))}}},{key:"_createTitles",value:function(t){var e=this;this.renderTitle()&&t.append("title").text((function(t){return e.title()(t.data)}))}},{key:"_applyLabelText",value:function(t){var e=this;t.text((function(t){var i=t.data;return!e._sliceHasNoData(i)&&!e._sliceTooSmall(t)||e._isSelectedSlice(t)?e.label()(t.data):""}))}},{key:"_positionLabels",value:function(t,e){var i=this;this._applyLabelText(t),X(t,this.transitionDuration(),this.transitionDelay()).attr("transform",(function(t){return i._labelPosition(t,e)})).attr("text-anchor","middle")}},{key:"_highlightSlice",value:function(t,e){this.select("g.pie-slice._".concat(t)).classed("highlight",e)}},{key:"_createLabels",value:function(t,e,i){var n=this;if(this.renderLabel()){var r=t.enter().append("text").attr("class",(function(t,e){var i="".concat(n._sliceCssClass," ").concat(n._labelCssClass," _").concat(e);return n._externalLabelRadius&&(i+=" external"),i})).on("click",E.eventHandler((function(t){return n._onClick(t)}))).on("mouseover",E.eventHandler((function(t){n._highlightSlice(t.index,!0)}))).on("mouseout",E.eventHandler((function(t){n._highlightSlice(t.index,!1)})));this._positionLabels(r,i),this._externalLabelRadius&&this._drawPaths&&this._updateLabelPaths(e,i)}}},{key:"_updateLabelPaths",value:function(t,e){var i=this,n=this._g.selectAll("polyline.".concat(this._sliceCssClass)).data(t);n.exit().remove(),n=n.enter().append("polyline").attr("class",(function(t,e){return"pie-path _".concat(e," ").concat(i._sliceCssClass)})).on("click",E.eventHandler((function(t){return i._onClick(t)}))).on("mouseover",E.eventHandler((function(t){i._highlightSlice(t.index,!0)}))).on("mouseout",E.eventHandler((function(t){i._highlightSlice(t.index,!1)}))).merge(n);var r=A.arc().outerRadius(this._radius-this._externalRadiusPadding+this._externalLabelRadius).innerRadius(this._radius-this._externalRadiusPadding),s=X(n,this.transitionDuration(),this.transitionDelay());s.attrTween?s.attrTween("points",(function(t){var i=this._current||t;i={startAngle:i.startAngle,endAngle:i.endAngle};var n=v.interpolate(i,t);return this._current=n(0),function(t){var i=n(t);return[e.centroid(i),r.centroid(i)]}})):s.attr("points",(function(t){return[e.centroid(t),r.centroid(t)]})),s.style("visibility",(function(t){return t.endAngle-t.startAngle<1e-4?"hidden":"visible"}))}},{key:"_updateElements",value:function(t,e){this._updateSlicePaths(t,e),this._updateLabels(t,e),this._updateTitles(t)}},{key:"_updateSlicePaths",value:function(t,e){var i=this,n=this._g.selectAll("g.".concat(this._sliceCssClass)).data(t).select("path").attr("d",(function(t,n){return i._safeArc(t,n,e)})),r=X(n,this.transitionDuration(),this.transitionDelay());if(r.attrTween){var s=this;r.attrTween("d",(function(t){return s._tweenPie(t,this)}))}r.attr("fill",(function(t,e){return i._fill(t,e)}))}},{key:"_updateLabels",value:function(t,e){if(this.renderLabel()){var i=this._g.selectAll("text.".concat(this._labelCssClass)).data(t);this._positionLabels(i,e),this._externalLabelRadius&&this._drawPaths&&this._updateLabelPaths(t,e)}}},{key:"_updateTitles",value:function(t){var e=this;this.renderTitle()&&this._g.selectAll("g.".concat(this._sliceCssClass)).data(t).select("title").text((function(t){return e.title()(t.data)}))}},{key:"_removeElements",value:function(t,e){t.exit().remove(),e.exit().remove()}},{key:"_highlightFilter",value:function(){var t=this;this.hasFilter()?this.selectAll("g.".concat(this._sliceCssClass)).each((function(e){t._isSelectedSlice(e)?t.highlightSelected(this):t.fadeDeselected(this)})):this.selectAll("g.".concat(this._sliceCssClass)).each((function(){t.resetHighlight(this)}))}},{key:"externalRadiusPadding",value:function(t){return arguments.length?(this._externalRadiusPadding=t,this):this._externalRadiusPadding}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"radius",value:function(t){return arguments.length?(this._givenRadius=t,this):this._givenRadius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx||this.width()/2}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy||this.height()/2}},{key:"_buildArcs",value:function(){return A.arc().outerRadius(this._radius-this._externalRadiusPadding).innerRadius(this._innerRadius)}},{key:"_isSelectedSlice",value:function(t){return this.hasFilter(this.cappedKeyAccessor(t.data))}},{key:"_doRedraw",value:function(){return this._drawChart(),this}},{key:"minAngleForLabel",value:function(t){return arguments.length?(this._minAngleForLabel=t,this):this._minAngleForLabel}},{key:"_pieLayout",value:function(){var t=this;return A.pie().sort(null).value((function(e){return t.cappedValueAccessor(e)}))}},{key:"_sliceTooSmall",value:function(t){var e=t.endAngle-t.startAngle;return isNaN(e)||e<this._minAngleForLabel}},{key:"_sliceHasNoData",value:function(t){return 0===this.cappedValueAccessor(t)}},{key:"_isOffCanvas",value:function(t){return!t||isNaN(t.startAngle)||isNaN(t.endAngle)}},{key:"_fill",value:function(t,e){return this.getColor(t.data,e)}},{key:"_onClick",value:function(t){this._g.attr("class")!==this._emptyCssClass&&this.onClick(t.data)}},{key:"_safeArc",value:function(t,e,i){var n=i(t,e);return n.indexOf("NaN")>=0&&(n="M0,0"),n}},{key:"emptyTitle",value:function(t){return 0===arguments.length?this._emptyTitle:(this._emptyTitle=t,this)}},{key:"externalLabels",value:function(t){return 0===arguments.length?this._externalLabelRadius:(this._externalLabelRadius=t||void 0,this)}},{key:"drawPaths",value:function(t){return 0===arguments.length?this._drawPaths:(this._drawPaths=t,this)}},{key:"_labelPosition",value:function(t,e){var i;return i=this._externalLabelRadius?A.arc().outerRadius(this._radius-this._externalRadiusPadding+this._externalLabelRadius).innerRadius(this._radius-this._externalRadiusPadding+this._externalLabelRadius).centroid(t):e.centroid(t),isNaN(i[0])||isNaN(i[1])?"translate(0,0)":"translate(".concat(i,")")}},{key:"legendables",value:function(){var t=this;return this.data().map((function(e,i){var n={name:e.key,data:e.value,others:e.others,chart:t};return n.color=t.getColor(e,i),n}))}},{key:"legendHighlight",value:function(t){this._highlightSliceFromLegendable(t,!0)}},{key:"legendReset",value:function(t){this._highlightSliceFromLegendable(t,!1)}},{key:"legendToggle",value:function(t){this.onClick({key:t.name,others:t.others})}},{key:"_highlightSliceFromLegendable",value:function(t,e){this.selectAll("g.pie-slice").each((function(i){t.name===i.data.key&&_.select(this).classed("highlight",e)}))}},{key:"_tweenPie",value:function(t,e){var i=this;t.innerRadius=this._innerRadius;var n=e._current;n=this._isOffCanvas(n)?{startAngle:0,endAngle:0}:{startAngle:n.startAngle,endAngle:n.endAngle};var r=v.interpolate(n,t);return e._current=r(0),function(t){return i._safeArc(r(t),0,i._buildArcs())}}}]),i}(yt(_t(ut))),ze=function(t,e){return new Ee(t,e)},Me=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._g=void 0,r._labelOffsetX=10,r._labelOffsetY=15,r._hasLabelOffsetY=!1,r._dyOffset="0.35em",r._titleLabelOffsetX=2,r._gap=5,r._fixedBarHeight=!1,r._rowCssClass="row",r._titleRowCssClass="titlerow",r._renderTitleLabel=!1,r._x=void 0,r._elasticX=void 0,r._xAxis=m.axisBottom(),r._rowData=void 0,r.rowsCap=r.cap,r.title((function(t){return"".concat(r.cappedKeyAccessor(t),": ").concat(r.cappedValueAccessor(t))})),r.label((function(t){return r.cappedKeyAccessor(t)})),r.anchor(t,n),r}return a(i,[{key:"_calculateAxisScale",value:function(){var t=this;if(!this._x||this._elasticX){var e=y.extent(this._rowData,(function(e){return t.cappedValueAccessor(e)}));e[0]>0&&(e[0]=0),e[1]<0&&(e[1]=0),this._x=g.scaleLinear().domain(e).range([0,this.effectiveWidth()])}this._xAxis.scale(this._x)}},{key:"_drawAxis",value:function(){var t=this._g.select("g.axis");this._calculateAxisScale(),t.empty()&&(t=this._g.append("g").attr("class","axis")),t.attr("transform","translate(0, ".concat(this.effectiveHeight(),")")),X(t,this.transitionDuration(),this.transitionDelay()).call(this._xAxis)}},{key:"_doRender",value:function(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform","translate(".concat(this.margins().left,",").concat(this.margins().top,")")),this._drawChart(),this}},{key:"x",value:function(t){return arguments.length?(this._x=t,this):this._x}},{key:"_drawGridLines",value:function(){var t=this;this._g.selectAll("g.tick").select("line.grid-line").remove(),this._g.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",(function(){return-t.effectiveHeight()}))}},{key:"_drawChart",value:function(){this._rowData=this.data(),this._drawAxis(),this._drawGridLines();var t=this._g.selectAll("g.".concat(this._rowCssClass)).data(this._rowData);this._removeElements(t),t=this._createElements(t).merge(t),this._updateElements(t)}},{key:"_createElements",value:function(t){var e=this,i=t.enter().append("g").attr("class",(function(t,i){return"".concat(e._rowCssClass," _").concat(i)}));return i.append("rect").attr("width",0),this._createLabels(i),i}},{key:"_removeElements",value:function(t){t.exit().remove()}},{key:"_rootValue",value:function(){var t=this._x(0);return t===-1/0||t!=t?this._x(1):t}},{key:"_updateElements",value:function(t){var e,i=this,n=this._rowData.length;e=this._fixedBarHeight?this._fixedBarHeight:(this.effectiveHeight()-(n+1)*this._gap)/n,this._hasLabelOffsetY||(this._labelOffsetY=e/2);var r=t.attr("transform",(function(t,n){return"translate(0,".concat((n+1)*i._gap+n*e,")")})).select("rect").attr("height",e).attr("fill",this.getColor).on("click",E.eventHandler((function(t){return i._onClick(t)}))).classed("dc-tabbable",this._keyboardAccessible).classed("deselected",(function(t){return!!i.hasFilter()&&!i._isSelectedRow(t)})).classed("selected",(function(t){return!!i.hasFilter()&&i._isSelectedRow(t)}));this._keyboardAccessible&&this._makeKeyboardAccessible((function(t){return i._onClick(t)})),X(r,this.transitionDuration(),this.transitionDelay()).attr("width",(function(t){return Math.abs(i._rootValue()-i._x(i.cappedValueAccessor(t)))})).attr("transform",(function(t){return i._translateX(t)})),this._createTitles(t),this._updateLabels(t)}},{key:"_createTitles",value:function(t){this.renderTitle()&&(t.select("title").remove(),t.append("title").text(this.title()))}},{key:"_createLabels",value:function(t){var e=this;this.renderLabel()&&t.append("text").on("click",E.eventHandler((function(t){return e._onClick(t)}))),this.renderTitleLabel()&&t.append("text").attr("class",this._titleRowCssClass).on("click",E.eventHandler((function(t){return e._onClick(t)})))}},{key:"_updateLabels",value:function(t){var e=this;if(this.renderLabel()){var i=t.select("text").attr("x",this._labelOffsetX).attr("y",this._labelOffsetY).attr("dy",this._dyOffset).on("click",E.eventHandler((function(t){return e._onClick(t)}))).attr("class",(function(t,i){return"".concat(e._rowCssClass," _").concat(i)})).text((function(t){return e.label()(t)}));X(i,this.transitionDuration(),this.transitionDelay()).attr("transform",(function(t){return e._translateX(t)}))}if(this.renderTitleLabel()){var n=t.select(".".concat(this._titleRowCssClass)).attr("x",this.effectiveWidth()-this._titleLabelOffsetX).attr("y",this._labelOffsetY).attr("dy",this._dyOffset).attr("text-anchor","end").on("click",E.eventHandler((function(t){return e._onClick(t)}))).attr("class",(function(t,i){return"".concat(e._titleRowCssClass," _").concat(i)})).text((function(t){return e.title()(t)}));X(n,this.transitionDuration(),this.transitionDelay()).attr("transform",(function(t){return e._translateX(t)}))}}},{key:"renderTitleLabel",value:function(t){return arguments.length?(this._renderTitleLabel=t,this):this._renderTitleLabel}},{key:"_onClick",value:function(t){this.onClick(t)}},{key:"_translateX",value:function(t){var e=this._x(this.cappedValueAccessor(t)),i=this._rootValue();return"translate(".concat(e>i?i:e,",0)")}},{key:"_doRedraw",value:function(){return this._drawChart(),this}},{key:"xAxis",value:function(t){return arguments.length?(this._xAxis=t,this):this._xAxis}},{key:"fixedBarHeight",value:function(t){return arguments.length?(this._fixedBarHeight=t,this):this._fixedBarHeight}},{key:"gap",value:function(t){return arguments.length?(this._gap=t,this):this._gap}},{key:"elasticX",value:function(t){return arguments.length?(this._elasticX=t,this):this._elasticX}},{key:"labelOffsetX",value:function(t){return arguments.length?(this._labelOffsetX=t,this):this._labelOffsetX}},{key:"labelOffsetY",value:function(t){return arguments.length?(this._labelOffsetY=t,this._hasLabelOffsetY=!0,this):this._labelOffsetY}},{key:"titleLabelOffsetX",value:function(t){return arguments.length?(this._titleLabelOffsetX=t,this):this._titleLabelOffsetX}},{key:"_isSelectedRow",value:function(t){return this.hasFilter(this.cappedKeyAccessor(t))}}]),i}(yt(_t(gt))),Ne=function(t,e){return new Me(t,e)},Ge=function(t){o(i,t);var e=d(i);function i(t,n){var r;l(this,i),(r=e.call(this))._symbol=A.symbol(),r._existenceAccessor=function(t){return t.value};var s=r.keyAccessor();return r.keyAccessor((function(t){return s(t)[0]})),r.valueAccessor((function(t){return s(t)[1]})),r.colorAccessor((function(){return r._groupName})),r.title((function(t){return"".concat(r.keyAccessor()(t),",").concat(r.valueAccessor()(t),": ").concat(r.existenceAccessor()(t))})),r._highlightedSize=7,r._symbolSize=5,r._excludedSize=3,r._excludedColor=null,r._excludedOpacity=1,r._emptySize=0,r._emptyOpacity=0,r._nonemptyOpacity=1,r._emptyColor=null,r._filtered=[],r._canvas=null,r._context=null,r._useCanvas=!1,r.brush(k.brush()),r._symbol.size((function(t,e){return r._elementSize(t,e)})),r.anchor(t,n),r}return a(i,[{key:"_canvasElementSize",value:function(t,e){return this._existenceAccessor(t)?e?this._symbolSize/Math.sqrt(Math.PI):this._excludedSize/Math.sqrt(Math.PI):this._emptySize/Math.sqrt(Math.PI)}},{key:"_elementSize",value:function(t,e){return this._existenceAccessor(t)?this._filtered[e]?Math.pow(this._symbolSize,2):Math.pow(this._excludedSize,2):Math.pow(this._emptySize,2)}},{key:"_locator",value:function(t){return"translate(".concat(this.x()(this.keyAccessor()(t)),",").concat(this.y()(this.valueAccessor()(t)),")")}},{key:"filter",value:function(t){return arguments.length?r(c(i.prototype),"filter",this).call(this,Q.RangedTwoDimensionalFilter(t)):r(c(i.prototype),"filter",this).call(this)}},{key:"resetSvg",value:function(){if(this._useCanvas){r(c(i.prototype),"resetSvg",this).call(this),this.select("canvas").remove();var t=this.svg();this.root().style("position","relative"),t.style("position","relative");var e=isNaN(parseInt(t.style("left"),10))?0:parseInt(t.style("left"),10),n=isNaN(parseInt(t.style("top"),10))?0:parseInt(t.style("top"),10),s=this.effectiveWidth(),a=this.effectiveHeight(),l=this.margins(),o=window.devicePixelRatio||1;return this._canvas=this.root().append("canvas").attr("x",0).attr("y",0).attr("width",s*o).attr("height",a*o).style("width","".concat(s,"px")).style("height","".concat(a,"px")).style("position","absolute").style("top","".concat(l.top+n,"px")).style("left","".concat(l.left+e,"px")).style("z-index",-1).style("pointer-events","none"),this._context=this._canvas.node().getContext("2d"),this._context.scale(o,o),this._context.rect(0,0,s,a),this._context.clip(),this._context.imageSmoothingQuality="high",this.svg()}return r(c(i.prototype),"resetSvg",this).call(this)}},{key:"_resizeCanvas",value:function(){var t=this.effectiveWidth(),e=this.effectiveHeight(),i=window.devicePixelRatio||1;this._canvas.attr("width",t*i).attr("height",e*i).style("width","".concat(t,"px")).style("height","".concat(e,"px")),this._context.scale(i,i)}},{key:"useCanvas",value:function(t){return arguments.length?(this._useCanvas=t,this):this._useCanvas}},{key:"canvas",value:function(t){return arguments.length?(this._canvas=t,this):this._canvas}},{key:"context",value:function(){return this._context}},{key:"_plotOnCanvas",value:function(t){var e=this;this._resizeCanvas();var i=this.context();i.clearRect(0,0,1*(i.canvas.width+2),1*(i.canvas.height+2)),this.data().forEach((function(n,r){var s=!e.filter()||e.filter().isFiltered([n.key[0],n.key[1]]),a=1;a=e._existenceAccessor(n)?s?e._nonemptyOpacity:e.excludedOpacity():e._emptyOpacity;var l=null;l=e._emptyColor&&!e._existenceAccessor(n)?e._emptyColor:e.excludedColor()&&!s?e.excludedColor():e.getColor(n);var o=e._canvasElementSize(n,s);if(t){var h=l===t.color;h||(a=.1),h&&(o=e._highlightedSize/Math.sqrt(Math.PI))}i.save(),i.globalAlpha=a,i.beginPath(),i.arc(e.x()(e.keyAccessor()(n)),e.y()(e.valueAccessor()(n)),o,0,2*Math.PI,!0),i.fillStyle=l,i.fill(),i.restore()}))}},{key:"_plotOnSVG",value:function(){var t=this,e=this.data();this._keyboardAccessible&&e.sort((function(e,i){return y.ascending(t.keyAccessor()(e),t.keyAccessor()(i))}));var i=this.chartBodyG().selectAll("path.symbol").data(e);X(i.exit(),this.transitionDuration(),this.transitionDelay()).attr("opacity",0).remove(),i=i.enter().append("path").attr("class","symbol").classed("dc-tabbable",this._keyboardAccessible).attr("opacity",0).attr("fill",this.getColor).attr("transform",(function(e){return t._locator(e)})).merge(i),this._keyboardAccessible&&(this._makeKeyboardAccessible(),i.order()),i.call((function(i){return t._renderTitles(i,e)})),i.each((function(e,i){t._filtered[i]=!t.filter()||t.filter().isFiltered([t.keyAccessor()(e),t.valueAccessor()(e)])})),X(i,this.transitionDuration(),this.transitionDelay()).attr("opacity",(function(e,i){return t._existenceAccessor(e)?t._filtered[i]?t._nonemptyOpacity:t.excludedOpacity():t._emptyOpacity})).attr("fill",(function(e,i){return t._emptyColor&&!t._existenceAccessor(e)?t._emptyColor:t.excludedColor()&&!t._filtered[i]?t.excludedColor():t.getColor(e)})).attr("transform",(function(e){return t._locator(e)})).attr("d",this._symbol)}},{key:"plotData",value:function(){this._useCanvas?this._plotOnCanvas():this._plotOnSVG()}},{key:"_renderTitles",value:function(t,e){var i=this;this.renderTitle()&&(t.selectAll("title").remove(),t.append("title").text((function(t){return i.title()(t)})))}},{key:"existenceAccessor",value:function(t){return arguments.length?(this._existenceAccessor=t,this):this._existenceAccessor}},{key:"symbol",value:function(t){return arguments.length?(this._symbol.type(t),this):this._symbol.type()}},{key:"customSymbol",value:function(t){var e=this;return arguments.length?(this._symbol=t,this._symbol.size((function(t,i){return e._elementSize(t,i)})),this):this._symbol}},{key:"symbolSize",value:function(t){return arguments.length?(this._symbolSize=t,this):this._symbolSize}},{key:"highlightedSize",value:function(t){return arguments.length?(this._highlightedSize=t,this):this._highlightedSize}},{key:"excludedSize",value:function(t){return arguments.length?(this._excludedSize=t,this):this._excludedSize}},{key:"excludedColor",value:function(t){return arguments.length?(this._excludedColor=t,this):this._excludedColor}},{key:"excludedOpacity",value:function(t){return arguments.length?(this._excludedOpacity=t,this):this._excludedOpacity}},{key:"emptySize",value:function(t){return arguments.length?(this._emptySize=t,this):this._emptySize}},{key:"hiddenSize",value:function(t){return arguments.length?this.emptySize(t):this.emptySize()}},{key:"emptyColor",value:function(t){return arguments.length?(this._emptyColor=t,this):this._emptyColor}},{key:"emptyOpacity",value:function(t){return arguments.length?(this._emptyOpacity=t,this):this._emptyOpacity}},{key:"nonemptyOpacity",value:function(t){return arguments.length?(this._nonemptyOpacity=t,this):this._emptyOpacity}},{key:"legendables",value:function(){return[{chart:this,name:this._groupName,color:this.getColor()}]}},{key:"legendHighlight",value:function(t){this._useCanvas?this._plotOnCanvas(t):(this._resizeSymbolsWhere((function(e){return e.attr("fill")===t.color}),this._highlightedSize),this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return _.select(this).attr("fill")!==t.color})).classed("fadeout",!0))}},{key:"legendReset",value:function(t){this._useCanvas?this._plotOnCanvas(t):(this._resizeSymbolsWhere((function(e){return e.attr("fill")===t.color}),this._symbolSize),this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return _.select(this).attr("fill")!==t.color})).classed("fadeout",!1))}},{key:"_resizeSymbolsWhere",value:function(t,e){var i=this.chartBodyG().selectAll(".chart-body path.symbol").filter((function(){return t(_.select(this))})),n=this._symbol.size();this._symbol.size(Math.pow(e,2)),X(i,this.transitionDuration(),this.transitionDelay()).attr("d",this._symbol),this._symbol.size(n)}},{key:"createBrushHandlePaths",value:function(){}},{key:"extendBrush",value:function(t){return this.round()&&(t[0]=t[0].map(this.round()),t[1]=t[1].map(this.round())),t}},{key:"brushIsEmpty",value:function(t){return!t||t[0][0]>=t[1][0]||t[0][1]>=t[1][1]}},{key:"_brushing",value:function(t){var e=this;if(!this._ignoreBrushEvents){var i=t.selection,n=this.brushIsEmpty(i);i&&(i=i.map((function(t){return t.map((function(t,i){return(0===i?e.x():e.y()).invert(t)}))})),i=this.extendBrush(i),n=n&&this.brushIsEmpty(i)),this.redrawBrush(i,!1);var r=n?null:Q.RangedTwoDimensionalFilter(i);J.trigger((function(){e.replaceFilter(r),e.redrawGroup()}),B.EVENT_DELAY)}}},{key:"redrawBrush",value:function(t,e){var i=this;if(this._gBrush=this.gBrush(),this.brushOn()&&this._gBrush)if(this.resizing()&&this.setBrushExtents(e),t){t=t.map((function(t){return t.map((function(t,e){return(0===e?i.x():i.y())(t)}))}));var n=j(e,this.transitionDuration(),this.transitionDelay())(this._gBrush);this._withoutBrushEvents((function(){n.call(i.brush().move,t)}))}else this._withoutBrushEvents((function(){i._gBrush.call(i.brush().move,t)}));this.fadeDeselectedArea(t)}}]),i}(Ct),Ye=function(t,e){return new Ge(t,e)},Ve="dc-select-menu",Ie="dc-select-option",We=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._select=void 0,r._promptText="Select all",r._multiple=!1,r._promptValue=null,r._numberVisible=null,r.data((function(t){return t.all().filter(r._filterDisplayed)})),r._filterDisplayed=function(t){return r.valueAccessor()(t)>0},r._order=function(t,e){return r.keyAccessor()(t)>r.keyAccessor()(e)?1:r.keyAccessor()(t)<r.keyAccessor()(e)?-1:0},r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){return this.select("select").remove(),this._select=this.root().append("select").classed(Ve,!0),this._select.append("option").text(this._promptText).attr("value",""),this._doRedraw(),this}},{key:"_doRedraw",value:function(){var t=this;return this._setAttributes(),this._renderOptions(),this.hasFilter()&&this._multiple?this._select.selectAll("option").property("selected",(function(e){return void 0!==e&&t.filters().indexOf(String(t.keyAccessor()(e)))>=0})):this.hasFilter()?this._select.property("value",this.filter()):this._select.property("value",""),this}},{key:"_renderOptions",value:function(){var t=this,e=this._select.selectAll("option.".concat(Ie)).data(this.data(),(function(e){return t.keyAccessor()(e)}));e.exit().remove(),e.enter().append("option").classed(Ie,!0).attr("value",(function(e){return t.keyAccessor()(e)})).merge(e).text(this.title()),this._select.selectAll("option.".concat(Ie)).sort(this._order),this._select.on("change",E.eventHandler((function(e,i){return t._onChange(e,i)})))}},{key:"_onChange",value:function(t,e){var i,n=e.target;1===(i=n.selectedOptions?Array.prototype.slice.call(n.selectedOptions).map((function(t){return t.value})):[].slice.call(e.target.options).filter((function(t){return t.selected})).map((function(t){return t.value}))).length&&""===i[0]?i=this._promptValue||null:this._multiple||1!==i.length||(i=i[0]),this.onChange(i)}},{key:"onChange",value:function(t){var e=this;t&&this._multiple?this.replaceFilter([t]):t?this.replaceFilter(t):this.filterAll(),J.trigger((function(){e.redrawGroup()}))}},{key:"_setAttributes",value:function(){this._multiple?this._select.attr("multiple",!0):this._select.attr("multiple",null),null!==this._numberVisible?this._select.attr("size",this._numberVisible):this._select.attr("size",null)}},{key:"order",value:function(t){return arguments.length?(this._order=t,this):this._order}},{key:"promptText",value:function(t){return arguments.length?(this._promptText=t,this):this._promptText}},{key:"filterDisplayed",value:function(t){return arguments.length?(this._filterDisplayed=t,this):this._filterDisplayed}},{key:"multiple",value:function(t){return arguments.length?(this._multiple=t,this):this._multiple}},{key:"promptValue",value:function(t){return arguments.length?(this._promptValue=t,this):this._promptValue}},{key:"numberVisible",value:function(t){return arguments.length?(this._numberVisible=t,this):this._numberVisible}},{key:"size",value:function(t){return P.warnOnce("selectMenu.size is ambiguous - use selectMenu.numberVisible instead"),arguments.length?this.numberVisible(t):this.numberVisible()}}]),i}(ut),Ue=function(t,e){return new We(t,e)},Xe=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this,t,n))._keySort=function(t,e){return y.ascending(r.keyAccessor()(t),r.keyAccessor()(e))},r._charts={},r._chartFunction=Be,r._chartGroup=n,r._seriesAccessor=void 0,r._seriesSort=y.ascending,r._valueSort=r._keySort,r._mandatoryAttributes().push("seriesAccessor","chart"),r.shareColors(!0),r}return a(i,[{key:"_compose",value:function(t){r(c(i.prototype),"compose",this).call(this,t)}},{key:"compose",value:function(t){throw new Error("Not supported for this chart type")}},{key:"_preprocessData",value:function(){var t,e=this,i=[],n=E.nester({key:this._seriesAccessor,sortKeys:this._seriesSort,sortValues:this._valueSort,entries:this.data()}).map((function(n,r){var s=e._charts[n.key]||e._chartFunction(e,e._chartGroup,n.key,r);return e._charts[n.key]||(t=!0),e._charts[n.key]=s,i.push(n.key),s.dimension(e.dimension()).group({all:"function"==typeof n.values?n.values:et.constant(n.values)},n.key).keyAccessor(e.keyAccessor()).valueAccessor(e.valueAccessor()).brushOn(!1)}));Object.keys(this._charts).filter((function(t){return-1===i.indexOf(t)})).forEach((function(i){e._clearChart(i),t=!0})),this._compose(n),t&&this.legend()&&this.legend().render()}},{key:"_clearChart",value:function(t){this._charts[t].g()&&this._charts[t].g().remove(),delete this._charts[t]}},{key:"_resetChildren",value:function(){Object.keys(this._charts).map(this._clearChart.bind(this)),this._charts={}}},{key:"chart",value:function(t){return arguments.length?(this._chartFunction=t,this._resetChildren(),this):this._chartFunction}},{key:"seriesAccessor",value:function(t){return arguments.length?(this._seriesAccessor=t,this._resetChildren(),this):this._seriesAccessor}},{key:"seriesSort",value:function(t){return arguments.length?(this._seriesSort=t,this._resetChildren(),this):this._seriesSort}},{key:"valueSort",value:function(t){return arguments.length?(this._valueSort=t,this._resetChildren(),this):this._valueSort}}]),i}(Zt),je=function(t,e){return new Xe(t,e)},Ke=.5,qe=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._sliceCssClass="pie-slice",r._emptyCssClass="empty-chart",r._emptyTitle="empty",r._radius=void 0,r._givenRadius=void 0,r._innerRadius=0,r._ringSizes=null,r._g=void 0,r._cx=void 0,r._cy=void 0,r._minAngleForLabel=Ke,r._externalLabelRadius=void 0,r.colorAccessor((function(t){return r.keyAccessor()(t)})),r.ordering(tt("key")),r.title((function(t){return"".concat(r.keyAccessor()(t),": ").concat(r._extendedValueAccessor(t))})),r.label((function(t){return r.keyAccessor()(t)})),r.renderLabel(!0),r.transitionDuration(350),r.anchor(t,n),r}return a(i,[{key:"_extendedValueAccessor",value:function(t){return t.path?t.value:this.valueAccessor()(t)}},{key:"_scaleRadius",value:function(t,e){if(0===t)return this._innerRadius;var i=y.sum(this.ringSizes().relativeRingSizes.slice(0,t)),n=t*(1/this.ringSizes().relativeRingSizes.length)/i,r=(e-this.ringSizes().rootOffset)/(1-this.ringSizes().rootOffset)*(this._radius-this._innerRadius);return this._innerRadius+r/n}},{key:"_doRender",value:function(){return this.resetSvg(),this._g=this.svg().append("g").attr("transform","translate(".concat(this.cx(),",").concat(this.cy(),")")),this._drawChart(),this}},{key:"_drawChart",value:function(){var t=y.min([this.width(),this.height()])/2;this._radius=this._givenRadius&&this._givenRadius<t?this._givenRadius:t;var e,i,n=this._buildArcs();if(y.sum(this.data(),this.valueAccessor())?(i=et.toHierarchy(this.data(),this.valueAccessor()),(e=this._partitionNodes(i)).nodes.shift(),this._g.classed(this._emptyCssClass,!1)):(i=et.toHierarchy([],(function(t){return t.value})),e=this._partitionNodes(i),this._g.classed(this._emptyCssClass,!0)),this.ringSizes().rootOffset=e.rootOffset,this.ringSizes().relativeRingSizes=e.relativeRingSizes,this._g){var r=this._g.selectAll("g.".concat(this._sliceCssClass)).data(e.nodes);this._createElements(r,n,e.nodes),this._updateElements(e.nodes,n),this._removeElements(r),this._highlightFilter(),X(this._g,this.transitionDuration(),this.transitionDelay()).attr("transform","translate(".concat(this.cx(),",").concat(this.cy(),")"))}}},{key:"_createElements",value:function(t,e,i){var n=this._createSliceNodes(t);this._createSlicePath(n,e),this._createTitles(n),this._createLabels(i,e)}},{key:"_createSliceNodes",value:function(t){var e=this;return t.enter().append("g").attr("class",(function(t,i){return"".concat(e._sliceCssClass," _").concat(i," ").concat(e._sliceCssClass,"-level-").concat(t.depth)}))}},{key:"_createSlicePath",value:function(t,e){var i=this,n=t.append("path").attr("fill",(function(t,e){return i._fill(t,e)})).on("click",E.eventHandler((function(t){return i.onClick(t)}))).classed("dc-tabbable",this._keyboardAccessible).attr("d",(function(t){return i._safeArc(e,t)}));this._keyboardAccessible&&this._makeKeyboardAccessible(this.onClick);var r=X(n,this.transitionDuration());if(r.attrTween){var s=this;r.attrTween("d",(function(t){return s._tweenSlice(t,this)}))}}},{key:"_createTitles",value:function(t){var e=this;this.renderTitle()&&t.append("title").text((function(t){return e.title()(t)}))}},{key:"_positionLabels",value:function(t,e){var i=this;X(t,this.transitionDuration()).attr("transform",(function(t){return i._labelPosition(t,e)})).attr("text-anchor","middle").text((function(t){return i._sliceHasNoData(t)||i._sliceTooSmall(t)?"":i.label()(t)}))}},{key:"_createLabels",value:function(t,e){var i=this;if(this.renderLabel()){var n=this._g.selectAll("text.".concat(this._sliceCssClass)).data(t);n.exit().remove();var r=n.enter().append("text").attr("class",(function(t,e){var n="".concat(i._sliceCssClass," _").concat(e);return i._externalLabelRadius&&(n+=" external"),n})).on("click",E.eventHandler((function(t){return i.onClick(t)})));this._positionLabels(r,e)}}},{key:"_updateElements",value:function(t,e){this._updateSlicePaths(t,e),this._updateLabels(t,e),this._updateTitles(t)}},{key:"_updateSlicePaths",value:function(t,e){var i=this,n=this._g.selectAll("g.".concat(this._sliceCssClass)).data(t).select("path").attr("d",(function(t,n){return i._safeArc(e,t)})),r=X(n,this.transitionDuration());if(r.attrTween){var s=this;r.attrTween("d",(function(t){return s._tweenSlice(t,this)}))}r.attr("fill",(function(t,e){return i._fill(t,e)}))}},{key:"_updateLabels",value:function(t,e){if(this.renderLabel()){var i=this._g.selectAll("text.".concat(this._sliceCssClass)).data(t);this._positionLabels(i,e)}}},{key:"_updateTitles",value:function(t){var e=this;this.renderTitle()&&this._g.selectAll("g.".concat(this._sliceCssClass)).data(t).select("title").text((function(t){return e.title()(t)}))}},{key:"_removeElements",value:function(t){t.exit().remove()}},{key:"_highlightFilter",value:function(){var t=this;t.hasFilter()?t.selectAll("g.".concat(t._sliceCssClass)).each((function(e){t._isSelectedSlice(e)?t.highlightSelected(this):t.fadeDeselected(this)})):t.selectAll("g.".concat(t._sliceCssClass)).each((function(e){t.resetHighlight(this)}))}},{key:"innerRadius",value:function(t){return arguments.length?(this._innerRadius=t,this):this._innerRadius}},{key:"radius",value:function(t){return arguments.length?(this._givenRadius=t,this):this._givenRadius}},{key:"cx",value:function(t){return arguments.length?(this._cx=t,this):this._cx||this.width()/2}},{key:"cy",value:function(t){return arguments.length?(this._cy=t,this):this._cy||this.height()/2}},{key:"minAngleForLabel",value:function(t){return arguments.length?(this._minAngleForLabel=t,this):this._minAngleForLabel}},{key:"emptyTitle",value:function(t){return 0===arguments.length?this._emptyTitle:(this._emptyTitle=t,this)}},{key:"externalLabels",value:function(t){return 0===arguments.length?this._externalLabelRadius:(this._externalLabelRadius=t||void 0,this)}},{key:"defaultRingSizes",value:function(){var t=this;return{partitionDy:function(){return t._radius*t._radius},scaleInnerRadius:function(e){return e.data.path&&1===e.data.path.length?t._innerRadius:Math.sqrt(e.y0)},scaleOuterRadius:function(t){return Math.sqrt(t.y1)},relativeRingSizesFunction:function(){return[]}}}},{key:"equalRingSizes",value:function(){return this.relativeRingSizes((function(t){for(var e=[],i=0;i<t;i++)e.push(1/t);return e}))}},{key:"relativeRingSizes",value:function(t){var e=this;function i(t,e){if(!Array.isArray(t))throw new O("relativeRingSizes function must return an array");var i=y.sum(t);if(Math.abs(i-1)>B.NEGLIGIBLE_NUMBER)throw new O("relativeRingSizes : portions must add up to 1, but sum was ".concat(i));if(t.length!==e)throw new O("relativeRingSizes : number of values must match number of rings (".concat(e,") but was ").concat(t.length))}return{partitionDy:function(){return 1},scaleInnerRadius:function(t){return e._scaleRadius(t.data.path.length-1,t.y0)},scaleOuterRadius:function(t){return e._scaleRadius(t.data.path.length,t.y1)},relativeRingSizesFunction:function(e){var n=t(e);return i(n,e),n}}}},{key:"ringSizes",value:function(t){return arguments.length?(this._ringSizes=t,this):(this._ringSizes||(this._ringSizes=this.defaultRingSizes()),this._ringSizes)}},{key:"_buildArcs",value:function(){var t=this;return A.arc().startAngle((function(t){return t.x0})).endAngle((function(t){return t.x1})).innerRadius((function(e){return t.ringSizes().scaleInnerRadius(e)})).outerRadius((function(e){return t.ringSizes().scaleOuterRadius(e)}))}},{key:"_isSelectedSlice",value:function(t){return this._isPathFiltered(t.path)}},{key:"_isPathFiltered",value:function(t){for(var e=0;e<this.filters().length;e++)if(this.filters()[e].isFiltered(t))return!0;return!1}},{key:"_filtersForPath",value:function(t){for(var e=Q.HierarchyFilter(t),i=[],n=0;n<this.filters().length;n++){var r=this.filters()[n];(r.isFiltered(t)||e.isFiltered(r))&&i.push(r)}return i}},{key:"_doRedraw",value:function(){return this._drawChart(),this}},{key:"_partitionNodes",value:function(t){var e=this,i=function(t){return{key:t.data.key,value:t.value}},n=w.hierarchy(t).sum((function(t){return t.children?0:e._extendedValueAccessor(t)})).sort((function(t,n){return y.ascending(e.ordering()(i(t)),e.ordering()(i(n)))}));w.partition().size([2*Math.PI,this.ringSizes().partitionDy()])(n);var r=n.descendants().map((function(t){return t.key=t.data.key,t.path=t.data.path,t})),s=this.ringSizes().relativeRingSizesFunction(n.height);return{nodes:r,rootOffset:n.y1,relativeRingSizes:s}}},{key:"_sliceTooSmall",value:function(t){var e=t.x1-t.x0;return isNaN(e)||e<this._minAngleForLabel}},{key:"_sliceHasNoData",value:function(t){return 0===this._extendedValueAccessor(t)}},{key:"_isOffCanvas",value:function(t){return!t||isNaN(t.x0)||isNaN(t.y0)}},{key:"_fill",value:function(t,e){return this.getColor(t.data,e)}},{key:"onClick",value:function(t){var e=this;if(this._g.attr("class")!==this._emptyCssClass){for(var i=t.path||t.key,n=Q.HierarchyFilter(i),r=this._filtersForPath(i),s=!1,a=r.length-1;a>=0;a--){var l=r[a];et.arraysIdentical(l,i)&&(s=!0),this.filter(r[a])}J.trigger((function(){s||e.filter(n),e.redrawGroup()}))}}},{key:"_safeArc",value:function(t,e){var i=t(e);return i.indexOf("NaN")>=0&&(i="M0,0"),i}},{key:"_labelPosition",value:function(t,e){var i;return i=this._externalLabelRadius?A.arc().outerRadius(this._radius+this._externalLabelRadius).innerRadius(this._radius+this._externalLabelRadius).centroid(t):e.centroid(t),isNaN(i[0])||isNaN(i[1])?"translate(0,0)":"translate(".concat(i,")")}},{key:"legendables",value:function(){var t=this;return this.data().map((function(e,i){var n={name:e.key,data:e.value,others:e.others,chart:t};return n.color=t.getColor(e,i),n}))}},{key:"legendHighlight",value:function(t){this._highlightSliceFromLegendable(t,!0)}},{key:"legendReset",value:function(t){this._highlightSliceFromLegendable(t,!1)}},{key:"legendToggle",value:function(t){this.onClick({key:t.name,others:t.others})}},{key:"_highlightSliceFromLegendable",value:function(t,e){this.selectAll("g.pie-slice").each((function(i){t.name===i.key&&_.select(this).classed("highlight",e)}))}},{key:"_tweenSlice",value:function(t,e){var i=this,n=e._current;this._isOffCanvas(n)&&(n={x0:0,x1:0,y0:0,y1:0});var r={x0:t.x0,x1:t.x1,y0:t.y0,y1:t.y1},s=v.interpolate(n,r);return e._current=s(0),function(e){return i._safeArc(i._buildArcs(),Object.assign({},t,s(e)))}}}]),i}(_t(ut)),Ze=function(t,e){return new qe(t,e)},Je="dc-text-filter-input",Qe=function(t){o(i,t);var e=d(i);function i(t,n){var r;return l(this,i),(r=e.call(this))._normalize=function(t){return t.toLowerCase()},r._filterFunctionFactory=function(t){return t=r._normalize(t),function(e){return-1!==r._normalize(e).indexOf(t)}},r._placeHolder="search",r.group((function(){throw"the group function on textFilterWidget should never be called, please report the issue"})),r.anchor(t,n),r}return a(i,[{key:"_doRender",value:function(){this.select("input").remove(),this._input=this.root().append("input").classed(Je,!0);var t=this;return this._input.on("input",(function(){t.dimension().filterFunction(t._filterFunctionFactory(this.value)),J.trigger((function(){t.redrawGroup()}),B.EVENT_DELAY)})),this._doRedraw(),this}},{key:"_doRedraw",value:function(){return this.root().selectAll("input").attr("placeholder",this._placeHolder),this}},{key:"normalize",value:function(t){return arguments.length?(this._normalize=t,this):this._normalize}},{key:"placeHolder",value:function(t){return arguments.length?(this._placeHolder=t,this):this._placeHolder}},{key:"filterFunctionFactory",value:function(t){return arguments.length?(this._filterFunctionFactory=t,this):this._filterFunctionFactory}}]),i}(ut),$e=function(t,e){return new Qe(t,e)};+L.version[0]<6&&Object.assign(E,{eventHandler:function(t){return function(e,i){t.call(this,e,_.event)}},callHandler:function(t,e,i,n){t.call(e,n)},nester:function(t){var e=t.key,i=t.sortKeys,n=t.sortValues,r=t.entries,s=R.nest().key(e);return i&&s.sortKeys(i),n&&s.sortValues(n),s.entries(r)},pointer:function(t,e){return _.mouse(e)}}),+L.version[0]>5&&Object.assign(E,{eventHandler:function(t){return function(e,i){t.call(this,i,e)}},callHandler:function(t,e,i,n){t.call(e,i,n)},nester:function(t){var e=t.key,i=t.sortKeys,r=t.sortValues,s=t.entries;r&&(s=n(s).sort(r));var a=y.groups(s,e);return i&&(a=a.sort(i)),a.map((function(t){return{key:"".concat(t[0]),values:t[1]}}))},pointer:_.pointer}),t.BadArgumentException=O,t.BarChart=Ft,t.BaseMixin=ut,t.BoxPlot=Tt,t.BubbleChart=zt,t.BubbleMixin=ft,t.BubbleOverlay=Vt,t.CapMixin=yt,t.CboxMenu=Xt,t.ColorMixin=_t,t.CompositeChart=Zt,t.Config=H,t.CoordinateGridMixin=Ct,t.DataCount=Qt,t.DataGrid=re,t.DataTable=ue,t.GeoChoroplethChart=_e,t.HeatMap=ge,t.HtmlLegend=pe,t.InvalidStateException=$,t.Legend=ke,t.LineChart=Oe,t.Logger=F,t.MarginMixin=gt,t.NumberDisplay=Pe,t.PieChart=Ee,t.RowChart=Me,t.ScatterPlot=Ge,t.SelectMenu=We,t.SeriesChart=Xe,t.StackMixin=Rt,t.SunburstChart=qe,t.TextFilterWidget=Qe,t.afterTransition=K,t.barChart=Pt,t.baseMixin=dt,t.boxPlot=Et,t.bubbleChart=Mt,t.bubbleOverlay=It,t.cboxMenu=jt,t.chartRegistry=z,t.compositeChart=Jt,t.config=T,t.constants=B,t.d3Box=St,t.d3compat=E,t.dataCount=$t,t.dataGrid=se,t.dataTable=de,t.deregisterAllCharts=Y,t.deregisterChart=N,t.events=J,t.filterAll=V,t.filters=Q,t.geoChoroplethChart=fe,t.hasChart=G,t.heatMap=ve,t.htmlLegend=me,t.instanceOfChart=Z,t.legend=be,t.lineChart=Be,t.logger=P,t.numberDisplay=He,t.optionalTransition=j,t.pieChart=ze,t.pluck=tt,t.printers=rt,t.redrawAll=U,t.refocusAll=I,t.registerChart=M,t.renderAll=W,t.renderlet=q,t.rowChart=Ne,t.scatterPlot=Ye,t.selectMenu=Ue,t.seriesChart=je,t.sunburstChart=Ze,t.textFilterWidget=$e,t.transition=X,t.units=st,t.utils=et,t.version=D,Object.defineProperty(t,"__esModule",{value:!0})}(e,i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826),i(8826))}}]);
//# sourceMappingURL=cfc251a4-f86f820ac13aa2487f54.js.map